<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>qwb2020-crypto | xrivendell7</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="modestudy AES 1、2 、6 CBC    比特翻转攻击    选择密文攻击、IV预测     padding oracle attack 3 、4、5 ECB    如果有几个相同的明文组，那么密文也将有几个相同的片段   选择明文攻击    加密图片 CTR   nonce重用  challenge112345[$] challenge 1[+] cookie:session&#x3D;6b">
<meta property="og:type" content="article">
<meta property="og:title" content="qwb2020-crypto">
<meta property="og:url" content="http://example.com/2020/11/02/qwb2020-crypto/index.html">
<meta property="og:site_name" content="xrivendell7">
<meta property="og:description" content="modestudy AES 1、2 、6 CBC    比特翻转攻击    选择密文攻击、IV预测     padding oracle attack 3 、4、5 ECB    如果有几个相同的明文组，那么密文也将有几个相同的片段   选择明文攻击    加密图片 CTR   nonce重用  challenge112345[$] challenge 1[+] cookie:session&#x3D;6b">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2020/11/02/qwb2020-crypto/1763435936656-12.png">
<meta property="og:image" content="http://example.com/2020/11/02/qwb2020-crypto/1763435936651-1.png">
<meta property="og:image" content="http://example.com/2020/11/02/qwb2020-crypto/1763435936651-2.png">
<meta property="og:image" content="http://example.com/2020/11/02/qwb2020-crypto/1763435936651-3.png">
<meta property="og:image" content="http://example.com/2020/11/02/qwb2020-crypto/1763435936651-4.png">
<meta property="og:image" content="http://example.com/2020/11/02/qwb2020-crypto/1763435936652-5.png">
<meta property="og:image" content="http://example.com/2020/11/02/qwb2020-crypto/1763435936652-6.png">
<meta property="og:image" content="http://example.com/2020/11/02/qwb2020-crypto/1763435936652-7.png">
<meta property="og:image" content="http://example.com/2020/11/02/qwb2020-crypto/1763435936652-8.png">
<meta property="og:image" content="http://example.com/2020/11/02/qwb2020-crypto/1763435936652-9.png">
<meta property="og:image" content="http://example.com/2020/11/02/qwb2020-crypto/1763435936652-10.png">
<meta property="og:image" content="http://example.com/2020/11/02/qwb2020-crypto/1763435936652-11.png">
<meta property="article:published_time" content="2020-11-02T03:18:11.000Z">
<meta property="article:modified_time" content="2025-11-22T01:21:00.773Z">
<meta property="article:author" content="xrivendell7">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2020/11/02/qwb2020-crypto/1763435936656-12.png">
  
    <link rel="alternate" href="/atom.xml" title="xrivendell7" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.2.0/css/fork-awesome.min.css">

<meta name="generator" content="Hexo 8.1.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">xrivendell7</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-qwb2020-crypto" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/11/02/qwb2020-crypto/" class="article-date">
  <time class="dt-published" datetime="2020-11-02T03:18:11.000Z" itemprop="datePublished">2020-11-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      qwb2020-crypto
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="modestudy"><a href="#modestudy" class="headerlink" title="modestudy"></a>modestudy</h1><blockquote>
<p>AES</p>
<p>1、2 、6 CBC    比特翻转攻击    选择密文攻击、IV预测     padding oracle attack</p>
<p>3 、4、5 ECB    如果有几个相同的明文组，那么密文也将有几个相同的片段   选择明文攻击    加密图片</p>
<p>CTR   nonce重用</p>
</blockquote>
<h2 id="challenge1"><a href="#challenge1" class="headerlink" title="challenge1"></a>challenge1</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">[$</span><span class="language-bash">] challenge 1</span></span><br><span class="line">[+] cookie:session=6b1f33a78c5b9c17;admin=0;checksum=552ebbeb9276a8cd9f741b7d29f8c9e1eb455757207ac420659e7eab56ddee25</span><br><span class="line">[+] checksum=aes128cbc.encrypt(session=6b1f33a78c5b9c17;admin=0)</span><br><span class="line">[+] only admin can see flag</span><br><span class="line">[-] cookie:（待输入）</span><br></pre></td></tr></table></figure>

<p>AES分块，每块都是128bits。</p>
<p>AES-CBC加解密如下：</p>
<p>$$Cᵢ &#x3D; Encrypt(Pᵢ ⊕ Cᵢ₋₁)\ Pᵢ &#x3D; Decrypt(Cᵢ) ⊕ Cᵢ₋₁$$</p>
<style>.xgyjeicuhntd{zoom:67%;}</style><img src="/2020/11/02/qwb2020-crypto/1763435936656-12.png" class="xgyjeicuhntd" alt="img">

<style>.tdxgpnlbbqfy{zoom:67%;}</style><img src="/2020/11/02/qwb2020-crypto/1763435936651-1.png" class="tdxgpnlbbqfy" alt="img">

<style>.qlhfgfttbwbb{zoom:67%;}</style><img src="/2020/11/02/qwb2020-crypto/1763435936651-2.png" class="qlhfgfttbwbb" alt="img">

<p>伪造一个合适的checksum，使得解密后admin&#x3D;1。</p>
<p>对于AES128的CBC解密模式，将密文按照16字节（128bits）分块，每个密文块先进行AES解密，然后再与前一个密文块（或IV）进行异或操作，得到明文块。</p>
<p>也就是可以通过伪造“0”（0x30）对应的密文块，从而使得解密后的明文块中的“0”变为“1”（0x31）。</p>
<p>$$<br>P_1(i) &#x3D; Decrypt(C_1(i)) \oplus C_0(i)\ 需要将C_0(i)修改为C_0^<code>(i)=C_0(i) \oplus \Delta\\ 则P_1^</code>(i)&#x3D;Decrypt(C_1(i)) \oplus C_0^<code>(i)=Decrypt(C_1(i)) \oplus C_0(i) \oplus \Delta=P_1(i)\oplus \Delta\\ 则\Delta=P_1(i) \oplus P_1^</code>(i)\ 则C_0^<code>(i)=C_0(i) \oplus \Delta=C_0(i)\oplus P_1(i)\oplus P_1^</code>(i)<br>$$<br>也就是说，只需计算C_0^&#96;(i)&#x3D;0xe1⊕0x30⊕0x31&#x3D;0xe0即可，也就是不进位模二加。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">session=6b1f33a7          552ebbeb9276a8cd9f741b7d29f8c9e1</span><br><span class="line">8c5b9c17;admin=0          eb455757207ac420659e7eab56ddee25</span><br><span class="line">session=6b1f33a78c5b9c17;admin=0;checksum=552ebbeb9276a8cd9f741b7d29f8c9e0eb455757207ac420659e7eab56ddee25</span><br></pre></td></tr></table></figure>

<h2 id="challenge2"><a href="#challenge2" class="headerlink" title="challenge2"></a>challenge2</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">[$</span><span class="language-bash">] challenge 2</span></span><br><span class="line">[+] sha256(iv)=11f595abc9d7b986d24fce986d1f9ddfb0d83f2f978db20b862ea730e570bff0</span><br><span class="line">[+] 1. server&#x27;s job: print aes_cbc_dec(key,iv,your_input_c).encode(&#x27;hex&#x27;)</span><br><span class="line">[+] 2. your job: guess iv</span><br><span class="line">[-] your choice:（待输入）</span><br></pre></td></tr></table></figure>

<p>令输入的密文为c0、c1，输出的明文为m0、m1。</p>
<p>$$dec(c_0)&#x3D;m_0 \oplus IV\ dec(c_1)&#x3D;m_1 \oplus c_0\ 若c_0&#x3D;c_1,则m_0 \oplus IV&#x3D;m_1 \oplus c_0,\ 则IV&#x3D;m_0 \oplus m_1 \oplus c_0$$</p>
<p>那么输入两次相同的16字节字符串，将这个字符串异或两次解密出的明文，即为IV。</p>
<h2 id="challenge3"><a href="#challenge3" class="headerlink" title="challenge3"></a>challenge3</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">[$</span><span class="language-bash">] challenge 3</span></span><br><span class="line">[+] cookie=session:0884ce7c;timedl=1;admin=0;guess_cookie_ma=1;guess_mp_ab=1;guess_cookie_mb=0;hell_pad=233</span><br><span class="line">[+] 128bit_ecb_encrypt(cookie):0632b3e7adb2f6d5ae4a92f553f2f4a4c9f95b099cfd8e3408137d134eb51d147045f278246a831fabdbdccde099b4b694b07e699ffae6a82c6cfbc4454816b1c78e5d1be8b67e235fbbfd2a75e73f32bac806808bc2e102db8f2c159b250415</span><br><span class="line">[+] only admin can see the flag</span><br><span class="line">[-] input your encrypted cookie(encode hex):（待输入）</span><br></pre></td></tr></table></figure>

<style>.natsghiwwtxb{zoom:67%;}</style><img src="/2020/11/02/qwb2020-crypto/1763435936651-3.png" class="natsghiwwtxb" alt="img">

<p>先将明密文分块</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">session:0884ce7c          0632b3e7adb2f6d5ae4a92f553f2f4a4</span><br><span class="line">;timedl=1;admin=          c9f95b099cfd8e3408137d134eb51d14</span><br><span class="line">0;guess_cookie_m          7045f278246a831fabdbdccde099b4b6</span><br><span class="line">a=1;guess_mp_ab=          94b07e699ffae6a82c6cfbc4454816b1</span><br><span class="line">1;guess_cookie_m          c78e5d1be8b67e235fbbfd2a75e73f32</span><br><span class="line">b=0;hell_pad=233          bac806808bc2e102db8f2c159b250415</span><br></pre></td></tr></table></figure>

<p>发现第三行和第五行只有第一个字符不一样，且正好是需要的字符“1”，因此把第五行的密文覆盖掉第三行的密文即可。</p>
<h2 id="challenge4"><a href="#challenge4" class="headerlink" title="challenge4"></a>challenge4</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">[$</span><span class="language-bash">] challenge 4</span></span><br><span class="line">[+] sha256(secret)=d014cbddd2cbb0fa2404c519c166bc85c03ee3445d643f451a5f5d6244e7e34d</span><br><span class="line">[+] assert len(secret)==16</span><br><span class="line">[+] 1. server&#x27;s job: print aes_ecb(key,input+secret+&#x27;\x00&#x27;*((16-(len(input+secret) % 16)) % 16))</span><br><span class="line">[+] 2. your job: guess secret</span><br><span class="line">[-] your choice:（待输入）</span><br></pre></td></tr></table></figure>

<p>由于ECB模式是分块加密，每块16字节，第一次先输入15字节”1“，会自动拼接1字节secret[0]，然后从0x0-0xff爆破这一字节，直至对应的密文块相同。第二次输入14字节”1“+secret[0]，会自动拼接1字节secret[1]，再次爆破。以此类推，直至爆破出全部secret。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&quot;x.x.x.x&quot;</span>, <span class="number">1111</span>)</span><br><span class="line"></span><br><span class="line">secret = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">17</span>):</span><br><span class="line">    padding = <span class="string">b&#x27;1&#x27;</span> * (<span class="number">16</span>-i)</span><br><span class="line">    p.sendlineafter(<span class="string">b&quot;your choice:&quot;</span>, <span class="string">b&quot;1&quot;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">b&quot;input(encode hex):&quot;</span>,padding.<span class="built_in">hex</span>().encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;before encrypted:&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(p.recvline)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;encrypted msg: &quot;</span>)</span><br><span class="line">    cypher = p.recvline.decode().strip()[:<span class="number">32</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;cipher: <span class="subst">&#123;cipher&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        test_padding = padding + secret + <span class="built_in">bytes</span>([j])</span><br><span class="line">        p.sendlineafter(<span class="string">b&quot;your choice:&quot;</span>, <span class="string">b&quot;1&quot;</span>)</span><br><span class="line">        p.sendlineafter(<span class="string">b&quot;input(encode hex):&quot;</span>, (test_padding.<span class="built_in">hex</span>().encode()))</span><br><span class="line">        p.recvuntil(<span class="string">b&quot;encrypted msg: &quot;</span>)</span><br><span class="line">        test_cypher = p.recvline.decode().strip()[:<span class="number">32</span>]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;test_cypher: <span class="subst">&#123;test_cypher&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> cypher == test_cypher:</span><br><span class="line">            secret += <span class="built_in">bytes</span>([j])</span><br><span class="line">    <span class="built_in">print</span>(secret)</span><br></pre></td></tr></table></figure>

<h2 id="challenge5"><a href="#challenge5" class="headerlink" title="challenge5"></a>challenge5</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">[$</span><span class="language-bash">] challenge 5</span></span><br><span class="line">[+] sha256(secret)=4c766c8749526dd1a14fdf37619d2fbebbbc2478e25e27e63e591ae0aafb305d</span><br><span class="line">[+] assert len(secret)==16</span><br><span class="line">[+] myblockencrypt_ecb(secret).encode(&quot;hex&quot;)=4c21cc2bc7941b224ed45bd02ee11b60</span><br><span class="line">[+] In this challenge, you need to try something.</span><br><span class="line">[+] 1. server&#x27;s job: print myblockencrypt_ecb(your_input)</span><br><span class="line">[+] 2. your job: guess secret</span><br><span class="line">[-] your choice:（待输入）</span><br></pre></td></tr></table></figure>

<p>尝试一些输入，直接拿writeup的例子说明。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[+] In this challenge, you need to try something.</span><br><span class="line">[+] 1. server&#x27;s job: print myblockencrypt_ecb(your_input)</span><br><span class="line">[+] 2. your job: guess secret</span><br><span class="line">[-] your choice:1</span><br><span class="line">[-] input(encode hex):80808080808080808080808080808080</span><br><span class="line">[+] myblockencrypt_ecb(your_input).encode(&quot;hex&quot;):35093509350935093509350935093509</span><br><span class="line">[+] 1. server&#x27;s job: print myblockencrypt_ecb(your_input)</span><br><span class="line">[+] 2. your job: guess secret</span><br><span class="line">[-] your choice:1</span><br><span class="line">[-] input(encode hex):66666666666666666666666666666666</span><br><span class="line">[+] myblockencrypt_ecb(your_input).encode(&quot;hex&quot;):022c022c022c022c022c022c022c022c</span><br></pre></td></tr></table></figure>

<p>加密实际上就是对每2byte进行置换，也就是分组长度位2byte的加密，实际上就是每16位一段进行加密且互不影响。列一个置换表出来，即可找到secret。数次访问的加密结果完全相同，可以认为这个加密是个固定的映射，因此尝试从0000到ffff的所有输入，然后去对密文就可以了。</p>
<h2 id="challenge6"><a href="#challenge6" class="headerlink" title="challenge6"></a>challenge6</h2><blockquote>
<p>padding oracle attack猜解IV</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">[$</span><span class="language-bash">] challenge 6</span></span><br><span class="line">[+] padding(m):m+chr(16-(len(m)%16))*(16-(len(m)%16))</span><br><span class="line">[+] unpadding(m):m[:-ord(m[-1])]</span><br><span class="line">[+] len(secret):16</span><br><span class="line">[+] iv+aes128_cbc(key,iv,padding(secret)):31313131313131313131313131313131891f3925b171f363bfc1ab0f4c03c9172cdfbd56dbd225d2accaf2b6fcbd0780</span><br><span class="line">[+] 1. server&#x27;s job: decrypt and unpadding</span><br><span class="line">[+] 2. your job: guess secret</span><br><span class="line">[-] your choice:（待输入）</span><br><span class="line"></span><br><span class="line">31313131313131313131313131313131 # IV，即ASCII &#x27;1&#x27;的重复</span><br><span class="line">891f3925b171f363bfc1ab0f4c03c917 # 第一组密文</span><br><span class="line">2cdfbd56dbd225d2accaf2b6fcbd0780 # 第二组密文</span><br></pre></td></tr></table></figure>

<p>首先详细了解CBC模式的加解密过程</p>
<style>.cnrelxhmnsgv{zoom:67%;}</style><img src="/2020/11/02/qwb2020-crypto/1763435936651-4.png" class="cnrelxhmnsgv" alt="img">

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 加密</span></span><br><span class="line"><span class="number">1</span>. 明文经过填充后，分为不同的组block，以组的方式对数据进行处理 </span><br><span class="line"><span class="number">2</span>. 初始化向量（IV）首先和第一组明文进行XOR（异或）操作，得到”中间值“</span><br><span class="line"><span class="number">3</span>. 采用密钥对中间值进行块加密，删除第一组加密的密文 （加密过程涉及复杂的变换、移位等） </span><br><span class="line"><span class="number">4</span>. 第一组加密的密文作为第二组的初始向量（IV），参与第二组明文的异或操作  </span><br><span class="line"><span class="number">5</span>. 依次执行块加密，最后将每一块的密文拼接成密文  </span><br></pre></td></tr></table></figure>

<style>.rnphwlbuxesj{zoom:67%;}</style><img src="/2020/11/02/qwb2020-crypto/1763435936652-5.png" class="rnphwlbuxesj" alt="img">

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">解密</span></span><br><span class="line">1. 会将密文进行分组（按照加密采用的分组大小），前面的第一组是初始化向量，从第二组开始才是真正的密文</span><br><span class="line">2. 使用加密密钥对密文的第一组进行解密，得到”中间值“  </span><br><span class="line">3. 将中间值和初始化向量进行异或，得到该组的明文</span><br><span class="line">4. 前一块密文是后一块密文的IV，通过异或中间值，得到明文</span><br><span class="line">5. 块全部解密完成后，拼接得到明文，密码算法校验明文的格式（填充格式是否正确）</span><br><span class="line">6. 校验通过得到明文，校验失败得到密文 </span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Padding Oracle 攻击的条件：</strong><ul>
<li><p>1、攻击者能够获得密文（ciphertext），以及密文对应的IV（初始化向量）</p>
</li>
<li><p>2、攻击者能够触发密文的解密过程，且能够知道密文的解密结果（因为需要根据结果不断尝试）。</p>
</li>
</ul>
</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/833582b2f560">Padding Oracle Attack(填充提示攻击)详解及验证 - 简书</a></p>
<p>通过上面的例题，详细了解一下padding oracle attack的原理，再针对上面的例题，从已知明文的角度详细了解一下加解密的过程。</p>
<style>.fyupntuszlgg{zoom:67%;}</style><img src="/2020/11/02/qwb2020-crypto/1763435936652-6.png" class="fyupntuszlgg" alt="img">

<style>.saxkropzqdvc{zoom:50%;}</style><img src="/2020/11/02/qwb2020-crypto/1763435936652-7.png" class="saxkropzqdvc" alt="img">

<p>例题密文如下，对其进行分组</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">7B216A634951170F  # IV</span><br><span class="line">F851D6CC68FC9537  # 第一组密文c1</span><br><span class="line">858795A28ED4AAC6  # 第二组密文c2</span><br></pre></td></tr></table></figure>

<p>那么可以首先通过构造初始向量IV破解第一组密文。</p>
<p>将IV设置为全0，向服务器提交IV+c1，即00000000000000000F851D6CC68FC9537。</p>
<style>.uryuvfjubknu{zoom:50%;}</style><img src="/2020/11/02/qwb2020-crypto/1763435936652-8.png" class="uryuvfjubknu" alt="img">

<p>首先假设明文从c1填充了最后一字节，那么按照填充规则，最后一字节明文应当是填充0x01。</p>
<p>那么此时全0 IV一定会解密失败，解密的过程是先解密密文得到一个中间值，然后将中间值和IV异或得到明文，而此时解密出的明文不满足填充规则，也就是不是0x01。</p>
<p>依次将IV最后一个字节从0x01~0xFF递增，直到解密的明文最后一个字节为0x01时，才是正确的padding，而此时IV为0000000000000003C，此时将0000000000000003C+c1提交给服务器，将会返回解密正确的提示，如下图。</p>
<style>.fedbgpmsnqtu{zoom:50%;}</style><img src="/2020/11/02/qwb2020-crypto/1763435936652-9.png" class="fedbgpmsnqtu" alt="img">

<p>此时已知IV的最后一个字节为0x3C，最后一个填充字节为0x01，那么即可得到c1解密过程中的中间值的最后一个字节是0x01^0x3C &#x3D; 0x3D。</p>
<p>接着利用同样的方法，假设c1填充了最后两字节，那么填充的内容应当是0x02 0x02。而此时已经知道了中间值的最后一字节是0x3D，那么可以得到IV的最后一字节应该是0x3D^0x02 &#x3D; 0x3F，那么将IV&#x3D;000000000000003F，此时开始从0x00~0xFF遍历IV的倒数第2个字节，直到返回解密成功，如下图</p>
<style>.dbkvrplemsum{zoom:50%;}</style><img src="/2020/11/02/qwb2020-crypto/1763435936652-10.png" class="dbkvrplemsum" alt="img">

<p>那么此时猜解出了中间值的倒数第二个字节是0x02^0x24 &#x3D; 0x26。以此类推，一直假设至填充8字节0x08，即可完成中间值猜解，如下图。</p>
<style>.clfielobxtne{zoom:50%;}</style><img src="/2020/11/02/qwb2020-crypto/1763435936652-11.png" class="clfielobxtne" alt="img">

<p>当中间值全部猜解完毕后，将中间值和题目给的IV异或，即可得到c1的明文。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x39</span> <span class="number">0x73</span> <span class="number">0x23</span> <span class="number">0x22</span> <span class="number">0x07</span> <span class="number">0x6A</span> <span class="number">0x26</span> <span class="number">0x3D</span>  <span class="comment"># c1中间值</span></span><br><span class="line"><span class="keyword">xor</span> </span><br><span class="line"><span class="number">0x7B</span> <span class="number">0x21</span> <span class="number">0x6A</span> <span class="number">0x63</span> <span class="number">0x49</span> <span class="number">0x51</span> <span class="number">0x17</span> <span class="number">0x0F</span>  <span class="comment"># 初始IV</span></span><br><span class="line">= </span><br><span class="line">BRIAN;<span class="number">12</span>  <span class="comment"># 明文m1</span></span><br></pre></td></tr></table></figure>

<p><strong>重点：第一组密文解密的中间值是一直不变的，同样也是正确的，我们通过构造IV值，使得最后一位填充值满足0x01，符合padding规则，则意味着程序解密成功（当前解密的结果肯定不是原来的明文），通过循环测试的方法，猜解出中间值得最后一位，再利用同样的方式猜解前面的中间值，直到获取到完整的中间值。</strong></p>
<p>继续破解第二组密文，第二组密文的IV向量是第一组密文，随意按照上述的逻辑构造第一组密文，即可破解出第二组明文。也就是从00000000000000000858795A28ED4AAC6开始遍历，直至找到中间值，即可求出明文m2。</p>
<p>再回到本题，本题解密并不返回结果，只返回能不能成功解密，iv可控，因此也是要利用padding oracle attack填充提示攻击。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">31313131313131313131313131313131 # IV，即ASCII &#x27;1&#x27;的重复</span><br><span class="line">891f3925b171f363bfc1ab0f4c03c917 # 第一组密文c1</span><br><span class="line">2cdfbd56dbd225d2accaf2b6fcbd0780 # 第二组密文c2</span><br><span class="line">dec(c1) = iv ^ m1</span><br><span class="line">dec(c2) = c1 ^ m2</span><br><span class="line">iv = 1111111111111111</span><br><span class="line">c1、c2已知</span><br><span class="line">m2 = &#x27;\x10&#x27;*16</span><br></pre></td></tr></table></figure>

<p>要求m1，就必须使用唯一与其相关的c1；利用填充规则，就必须将c1置于最后一段。尝试以下的解密输入：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">第一段：&#x27;\x00&#x27; * 15 + ?</span><br><span class="line">第二段：c1</span><br></pre></td></tr></table></figure>

<p>对于?取值0~255依次进行测试。根据CBC解密流程，如果当?&#x3D;a时能够解密成功，说明此时解密的第一段明文最后一字节为\x01，即m1的末位为 a ^ iv ^ 0x01，a即为不变的中间值的最后一位。</p>
<p>接着用a ^ 0x01 ^ 0x02来代替a作为固定末位，此时解密的最后一位固定为\x02。继续调整输入第一段的倒数第二位，使得解密结果末尾为\x02\x02，此时解密成功，可求出m1的倒数第二位。以此类推可以求出m1。再把c1作为c2的IV，按照同样的方法求得m2。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">chal6</span>():</span><br><span class="line">    io.sendlineafter(<span class="string">&quot;[-] your choice:&quot;</span>, <span class="string">&quot;6&quot;</span>)</span><br><span class="line">    io.recvuntil(<span class="string">&quot;[+] iv+aes128_cbc(key,iv,padding(secret)):&quot;</span>)</span><br><span class="line">    msg = unhexlify(io.recvline().strip())</span><br><span class="line">    iv, cipher = msg[:<span class="number">16</span>], msg[<span class="number">16</span>:<span class="number">32</span>]</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    暴力破解第一段密文</span></span><br><span class="line"><span class="string">    secret = b&#x27;&#x27;</span></span><br><span class="line"><span class="string">    for i in range(16):</span></span><br><span class="line"><span class="string">        for j in tqdm(range(0x100)):</span></span><br><span class="line"><span class="string">            ct = iv[:15-i] + bytes([j]) + iv[16-i:] + cipher</span></span><br><span class="line"><span class="string">            if chal6_dec(ct) == True:</span></span><br><span class="line"><span class="string">                secret = bytes([iv[-i - 1] ^ j ^ (i + 1)]) + secret</span></span><br><span class="line"><span class="string">                iv = iv[:15-i] + xor(ct[15-i:16], bytes([(i + 1) ^ (i + 2)]) * (i + 1))</span></span><br><span class="line"><span class="string">                break</span></span><br><span class="line"><span class="string">        print(secret)</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    secret = <span class="string">b&#x27;\xe6?\xee\x07\xa3\x07\xaa\xc8\x8em\xb5\xa0\x90&#x27;</span></span><br><span class="line">    iv = iv[:<span class="number">16</span>-<span class="built_in">len</span>(secret)] + xor(iv[<span class="number">16</span>-<span class="built_in">len</span>(secret):], xor(secret, <span class="built_in">bytes</span>([<span class="built_in">len</span>(secret) + <span class="number">1</span>]) * <span class="built_in">len</span>(secret)))</span><br><span class="line">    <span class="comment"># context.log_level = &#x27;debug&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(secret), <span class="number">16</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">0x100</span>)):</span><br><span class="line">            ct = iv[:<span class="number">15</span>-i] + <span class="built_in">bytes</span>([j]) + iv[<span class="number">16</span>-i:] + cipher</span><br><span class="line">            <span class="keyword">if</span> chal6_dec(ct) == <span class="literal">True</span>:</span><br><span class="line">                secret = <span class="built_in">bytes</span>([iv[-i - <span class="number">1</span>] ^ j ^ (i + <span class="number">1</span>)]) + secret</span><br><span class="line">                iv = iv[:<span class="number">15</span>-i] + xor(ct[<span class="number">15</span>-i:<span class="number">16</span>], <span class="built_in">bytes</span>([(i + <span class="number">1</span>) ^ (i + <span class="number">2</span>)]) * (i + <span class="number">1</span>))</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="built_in">print</span>(secret)</span><br><span class="line">    io.sendlineafter(<span class="string">&quot;[-] your choice:&quot;</span>, <span class="string">&quot;2&quot;</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">&quot;[-] secret(encode hex):&quot;</span>, hexlify(secret))</span><br></pre></td></tr></table></figure>

<h1 id="fault"><a href="#fault" class="headerlink" title="fault"></a>fault</h1><blockquote>
<p>国密SM4</p>
<p><a target="_blank" rel="noopener" href="https://blog.soreatu.com/posts/case-study-differetial-cryptanalysis-attack/#%E5%BC%BA%E7%BD%91%E6%9D%AF2020-fault">Case Study: Differetial Cryptanalysis Attack | Soreat_u’s Blog</a></p>
<p><a target="_blank" rel="noopener" href="https://su-team.cn/posts/48139.html#modestudy">强网杯 S4 SU Write-Up - su-team</a></p>
</blockquote>
<h1 id="flagsystem"><a href="#flagsystem" class="headerlink" title="flagsystem"></a>flagsystem</h1><p>首先获得原始令牌，注册得到(signature, data)</p>
<p>由于seed是利用time.time()时间戳生成，可±10秒进行爆破，获取正确的seed后，可获取初始的random_constants和random_iv。</p>
<p>爆破sha256的前缀破解pow。</p>
<p>构造恶意数据，在原始数据后添加新的权限字段0xFF，也就是创建权限为0xFF的数据。</p>
<p>li用爆破出的seed计算而已数据的哈希</p>
<p>利用给出的N和e，以及给出的签名消sign也就是密文c，已知N、e、c可以通过一系列方法求p、q、d。</p>
<p>然后直接用d对哈希进行签名，获取权限为0xFF的令牌。</p>
<p><strong>没找到wp，先放放。</strong></p>
<h1 id="hitcon-ctf2025-Sharing-is-caring"><a href="#hitcon-ctf2025-Sharing-is-caring" class="headerlink" title="hitcon ctf2025_Sharing is caring"></a>hitcon ctf2025_Sharing is caring</h1><blockquote>
<p>李博士打hitcon ctf2025时有一道re题，解开后是一道密码题</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-- coding: utf-8 --</span></span><br><span class="line"><span class="keyword">from</span> fractions <span class="keyword">import</span> Fraction</span><br><span class="line"><span class="keyword">from</span> IPython <span class="keyword">import</span> embed</span><br><span class="line"></span><br><span class="line">rrt = [</span><br><span class="line">    <span class="number">0x1F0C22AD1FC79BAD9998E741F118A0E4DC6186734A25A072CB657AC3E9B05DB5F30451DD9E8F4BE8F</span>,</span><br><span class="line">    -<span class="number">0xF8611568FE3CDD6CCCC73A0F88C50726E30C339A512D03965B2BD61F4D82EDAF98228EECF47A5F48</span>,</span><br><span class="line">    <span class="number">0xA81F883356FCE6CC28C3E8BBD7E1D0957F5336FA947DA83937D361F8D443638E38F1C480262E9B49</span>,</span><br><span class="line">    -<span class="number">0x1FFD4D76D7563C2929E079FD815862501DDBCF6F1B71520D3894879E8193D46F719A38A4343BF0BB</span>,</span><br><span class="line">    -<span class="number">0x258A737960D8A6770B5A88E2DBD5CB18747D7CFC0C2AEEB727E31FF15463E85B42BAEE49D9E0CC0F</span>,</span><br><span class="line">    <span class="number">0x42D8D6C7C60482107421060735391BD75AC329010148D32EC2E872178C87E382432F5B00FA07C01C</span>,</span><br><span class="line">    -<span class="number">0x11C3AC8DE06A1450EA78018E230686B2EE978E7A4D98560D51C61DE7A8362CA6DDCC45E1147B8885</span>,</span><br><span class="line">    <span class="number">0x43AA96AA8C3002C6EBB9BE5563667785F6E9DFAB912FAAF741CFBD0A03428F365E0FCE3284B3B8B3</span>,</span><br><span class="line">    <span class="number">0x7AFDE950DD9AE47637ED2C6FB7250DD4DB4B3DDE2284A9B87582E1F73C91440687E33CB2BBFC5189B</span>,</span><br><span class="line">    -<span class="number">0x3CA029BD608E714CA5F1C7B035282C42D00DF1FEB16ABD40D0F976F75EA6D3686227395F604A25676D</span>,</span><br><span class="line">    <span class="number">0x166CB92444160450747991DBBDF057BAF85916E5F0A355CCD7ECC9A0D993582AA923F5B4FB2ABABC81</span>,</span><br><span class="line">    -<span class="number">0x663E489FBDAEC80D1884477F020778B5A2D090399A17B6AE5817A8EF1EA99F655003967D3A609224FD</span>,</span><br><span class="line">    <span class="number">0x1BAB93E013E3D17B5364244083170DFE0BD5A1F99BA1643851400892E0D4AADEDF122B0507F93BC27F</span>,</span><br><span class="line">    -<span class="number">0xCC39640F78F10E9EFD61E2B44CFEE4D9117B4A3A84139BAF9C5EDA67C578021CD48C4B57E6AF0F44F</span>,</span><br><span class="line">    <span class="number">0x21F2983A517C4FAEA38B3812E0331396A03FA4F4405203C1756C0C4167589CFAABDB61429C901B23315</span>,</span><br><span class="line">    -<span class="number">0xD0043580FE877D8ED2B5DA1F3DD452925BD11D7F0A4BEB5F7614785BECE71FAF6CFE03AD64B8234D33</span>,</span><br><span class="line">    <span class="number">0x633DD371A42F8D22B2D0CB201CCB16EBBA8F405FF2B113814CE8DFDD36F81C6AE0B58158186627766A9</span>,</span><br><span class="line">    -<span class="number">0xB819D98EB71AC2A8B05296FA5FC31454AD69C910704A6EB205E2B2026BEFD69851240F5BAD1B20319</span>,</span><br><span class="line">    <span class="number">0x252235BEDC59ECEEDC518812E51AFD4724A090E89A5A10509A9F03C53C3663DCB9755DB5D90EA7311D3</span>,</span><br><span class="line">    -<span class="number">0xE2178F78C86017B224413FEAE2C4F3C32524C72BEA949AF624BA5012A7266BAE3A83036A747E10D5D05</span>,</span><br><span class="line">    <span class="number">0x605197C25F89C947BC425DA91858B982F21C31615F61418E16420CD725CA6038B7A0FF8110546470032F</span>,</span><br><span class="line">    -<span class="number">0x1B45970BD9A24B31CCF3F3DDBAF6E55F85EAB899B8256438136F66C9D6ACA008FC5EFC3A68C643F30049</span>,</span><br><span class="line">    <span class="number">0x25CAB05492FBBE7F64C1D2DAF9601F29992C5BA78F18D0AFDE3BB1267496AFDD4521F24812809F71FFBF</span>,</span><br><span class="line">    -<span class="number">0x8ED7098BC09611E0669A9D014C7E1A3B32B54801C45FE1DA070EAC5D6C2E0D77063A214ABD52D96CE97</span>,</span><br><span class="line">    <span class="number">0x2413FEDDCE36DE145AE57CD141C38176341F00E5CB8CFDB4C8DFDA319C80C8A4AFF337E49F73DF2EF06F</span>,</span><br><span class="line">    -<span class="number">0x2F3203C80A7C3442696575EDB2962C106836B1A5B8120FDAC440F06895C75F5CF034D3F586E0AD6A08479</span>,</span><br><span class="line">    <span class="number">0xF46ECA5D31CD4D7493DBFB47A83FE50B0853451DFDB346086AEDA8C1BECCCF97B60D1E9160091FF8D773</span>,</span><br><span class="line">    -<span class="number">0x3470EBC21C3C8E65D3B15C3D01681A308F65D5E69E52DB1D847C51C96D60FB0BF09CA6A3A1EAB9125D335</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">ttr = [</span><br><span class="line">    <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">240</span>, <span class="number">40320</span>, <span class="number">362880</span>, <span class="number">403200</span>, <span class="number">7983360</span>, <span class="number">11975040</span>, <span class="number">37065600</span>,</span><br><span class="line">    <span class="number">0x2E6519800</span>, <span class="number">0xA261D9400</span>, <span class="number">0x32BE93E4000</span>, <span class="number">0x466BBD9000</span>, <span class="number">0xC218F5AE8000</span>,</span><br><span class="line">    <span class="number">0x4807432BC18000</span>, <span class="number">0x21C3677C82B40000</span>, <span class="number">0xB141DF4DAE310000</span>, <span class="number">0xF3BA930ACF8360000</span>,</span><br><span class="line">    <span class="number">0x280A89874301780000</span>, <span class="number">0x5B65F7240DD14400000</span>, <span class="number">0x446E0208A903029400000</span>,</span><br><span class="line">    <span class="number">0xDE65869C2549C86100000</span>, <span class="number">0x211D3C0B03AB74E50800000</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 0~29，使用分数运算计算一个大整数，基于rrt和ttr数组的有理数运算</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rrn</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="comment"># 特殊情况，rrn(17)=1, rrn(18)=0</span></span><br><span class="line">    <span class="keyword">if</span> n <span class="keyword">in</span> (<span class="number">17</span>, <span class="number">18</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="number">18</span> - n</span><br><span class="line">    F = Fraction</span><br><span class="line">    n = <span class="built_in">len</span>(rrt) <span class="comment"># 28</span></span><br><span class="line">    acc = F(<span class="number">0</span>, <span class="number">1</span>) <span class="comment"># 累加</span></span><br><span class="line">    mul = F(<span class="number">1</span>, <span class="number">1</span>) <span class="comment"># 累乘</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        acc += F(rrt[i], ttr[i]) * mul</span><br><span class="line">        mul *= F(n - i, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(acc)</span><br><span class="line"></span><br><span class="line">triple = [(rrn(<span class="number">7</span>), rrn(<span class="number">8</span>), rrn(<span class="number">9</span>)), (rrn(<span class="number">10</span>), rrn(<span class="number">11</span>), rrn(<span class="number">12</span>)), (rrn(<span class="number">13</span>), rrn(<span class="number">14</span>), rrn(<span class="number">15</span>))]</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">0 4144803293417776131310451317495228706499130241044716671850484110288180082374299088166459295448719</span></span><br><span class="line"><span class="string">1 2072401646708888065655225658747614353249565120522358335925242055144090041187149544083229647724359</span></span><br><span class="line"><span class="string">2 1402769202505631727601810730581776197716350949074282314174097681867464170562021714349605843278664</span></span><br><span class="line"><span class="string">3 1335174568503939352563889373190143608146136792487939183543780907770759908268721571509488188235873</span></span><br><span class="line"><span class="string">4 442427645836698445267007097625472942305363362863130591746066528455945891079759637465163543741507</span></span><br><span class="line"><span class="string">5 1132891618999846053017541510085320021631035459029704515373044135313614915469753666299478525789537</span></span><br><span class="line"><span class="string">6 3440625422497330758356285966425842805899353260932540945262402832827054563258418833844309632149096</span></span><br><span class="line"><span class="string">7 51966</span></span><br><span class="line"><span class="string">8 480442839669953990717445646260333383833736214883976558477525831992994289143305421629761482429714</span></span><br><span class="line"><span class="string">9 680701978345522085049694956190292511497787092168524280991013677878931201637910598103187515536181</span></span><br><span class="line"><span class="string">10 47806</span></span><br><span class="line"><span class="string">11 253717457675323180603201716971045682091261518437666533915787790782521696917056900361404824269689</span></span><br><span class="line"><span class="string">12 99768326317759269813131181172947299870925613919195157126671930387206518545837120733862757382354</span></span><br><span class="line"><span class="string">13 201527</span></span><br><span class="line"><span class="string">14 782319055923618868639890136618720319997476308047895888006842867173403800015590219030945524995543</span></span><br><span class="line"><span class="string">15 944213788775446264472010893716848921879528565854393198519311752189219209422386607874556309845161</span></span><br><span class="line"><span class="string">16 865967982817260602973374066425323583617367103807916127263320767485154348516392723060969424214055</span></span><br><span class="line"><span class="string">17 1</span></span><br><span class="line"><span class="string">18 0</span></span><br><span class="line"><span class="string">19 3</span></span><br><span class="line"><span class="string">20 6</span></span><br><span class="line"><span class="string">21 2</span></span><br><span class="line"><span class="string">22 4919</span></span><br><span class="line"><span class="string">23 132146363252892079238955852043754382244951307426448497798760465957265430114543661757753602857394</span></span><br><span class="line"><span class="string">24 57005</span></span><br><span class="line"><span class="string">25 775309903033854570882823603825659470664893675806480830434450057789819902048494192286724670375083</span></span><br><span class="line"><span class="string">26 48879</span></span><br><span class="line"><span class="string">27 118549588096765345719828273586922254620646262475213503758232906237813765902929584873401252181598</span></span><br><span class="line"><span class="string">28 -17927833311757106272913600706201967593825828617408413393921146586262101308545356473435323364772083605196</span></span><br><span class="line"><span class="string">29 -480626274858555850271738168267749839659770589949752910052809542789249901244053865124196593810519595669432</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># 位加法运算，计算两个大数相加</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">while</span> b:</span><br><span class="line">        carry = a &amp; a</span><br><span class="line">        a = a ^ b</span><br><span class="line">        b = carry &lt;&lt; <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"><span class="comment"># 位运算乘法，计算两个数相乘</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mul</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> b &lt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span> * mul(a, -b)</span><br><span class="line">    acc = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> b:</span><br><span class="line">        acc += a <span class="keyword">if</span> (b &amp; <span class="number">1</span>) <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        a &lt;&lt;= <span class="number">1</span></span><br><span class="line">        b &gt;&gt;= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> acc</span><br><span class="line"><span class="comment"># 模幂运算，例如计算modexp(3, 13, 7)，也就是计算3^13 mod 7的结果res=3</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">modexp</span>(<span class="params">base, exp, mod</span>):</span><br><span class="line">    res = <span class="number">1</span></span><br><span class="line">    b = base % mod</span><br><span class="line">    e = exp</span><br><span class="line">    <span class="keyword">while</span> e:</span><br><span class="line">        <span class="keyword">if</span> e &amp; <span class="number">1</span>:</span><br><span class="line">            res = mul(res, b) % mod</span><br><span class="line">        b = mul(b, b) % mod</span><br><span class="line">        e &gt;&gt;= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verify</span>(<span class="params">k, v1, v2</span>):</span><br><span class="line">    <span class="comment"># 获取模数</span></span><br><span class="line">    M = rrn(<span class="number">0</span>)</span><br><span class="line">    <span class="comment"># 计算左边(rrn(2)^v1 * rrn(3)^v2) mod M</span></span><br><span class="line">    left = mul(modexp(rrn(<span class="number">2</span>), v1, M), modexp(rrn(<span class="number">3</span>), v2, M)) % M</span><br><span class="line">    acc, step = <span class="number">1</span>,<span class="number">1</span></span><br><span class="line">    <span class="comment"># 计算右边，累乘rrn(4)^1 * rrn(5)^k * rrn(6)^(k^2)</span></span><br><span class="line">    <span class="keyword">for</span> val <span class="keyword">in</span> [rrn(<span class="number">4</span>), rrn(<span class="number">5</span>), rrn(<span class="number">6</span>)]:</span><br><span class="line">        acc = mul(acc, modexp(val, step, M)) % M</span><br><span class="line">        step = mul(step, k) % rrn(<span class="number">1</span>) <span class="comment"># step *= k % rrn(1)</span></span><br><span class="line">    <span class="comment"># 验证左右是否相等</span></span><br><span class="line">    <span class="keyword">return</span> left == acc</span><br><span class="line"></span><br><span class="line"><span class="comment"># 扩展欧几里得求逆元</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv</span>(<span class="params">a, m</span>):</span><br><span class="line">    a0, a1 = <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    b0, b1 = a % m, m</span><br><span class="line">    <span class="keyword">while</span> b0 &gt; <span class="number">1</span>:</span><br><span class="line">        q = b1 // b0</span><br><span class="line">        a0, a1 = (a1 - mul(a0, q)), (b1 - mul(b0, q))</span><br><span class="line">        a0, b0, a1, b1 = a0, a1, a0, b0</span><br><span class="line">    <span class="keyword">return</span> a0 % m</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rtnr</span>(<span class="params">arr</span>):</span><br><span class="line">    <span class="comment"># 验证arr是否为列表或元组，且至少包含3个元素</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(arr, (<span class="built_in">list</span>, <span class="built_in">tuple</span>)) <span class="keyword">or</span> <span class="built_in">len</span>(arr) &lt; <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="comment"># 将arr变成键值对增加至hello</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27; 原hello</span></span><br><span class="line"><span class="string">    hello = &#123;</span></span><br><span class="line"><span class="string">    rrn(7):  (rrn(8),  rrn(9)),</span></span><br><span class="line"><span class="string">    rrn(10): (rrn(11), rrn(12)),</span></span><br><span class="line"><span class="string">    rrn(13): (rrn(14), rrn(15))&#125;</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    hello = &#123;&#125;</span><br><span class="line">    hello = &#123;a: (b, c) <span class="keyword">for</span> a, b, c <span class="keyword">in</span> triple&#125;</span><br><span class="line">    <span class="keyword">for</span> a, b, c <span class="keyword">in</span> arr:</span><br><span class="line">        hello[a] = (b, c)</span><br><span class="line">    <span class="comment"># 组6</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(hello) != <span class="number">6</span>: <span class="comment"># 6</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="comment"># 验证hello的每一对键值对</span></span><br><span class="line">    <span class="keyword">for</span> k, (v1, v2) <span class="keyword">in</span> hello.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> verify(k, v1, v2):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># rrn(22), rrn(24),  rrn(26)</span></span><br><span class="line">        chosen = &#123;a <span class="keyword">for</span> a, b, c <span class="keyword">in</span> arr[:<span class="number">3</span>]&#125; </span><br><span class="line">        <span class="comment"># picked = [(rrn(22), a), (rrn(24), b), (rrn(26), c)]</span></span><br><span class="line">        picked = [(x, hello[x][<span class="number">0</span>]) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">sorted</span>(chosen) <span class="keyword">if</span> x <span class="keyword">in</span> hello]</span><br><span class="line">        <span class="comment"># [(rrn(7), rrn(9)), (rrn(10), rrn(12)), (rrn(13), rrn(15))]</span></span><br><span class="line">        leftovers = [(a, c) <span class="keyword">for</span> a, c, _ <span class="keyword">in</span> triple]  <span class="comment"># 原三元组里挑两个</span></span><br><span class="line">        rnrn = []</span><br><span class="line">        <span class="comment"># rnrn = [(rrn(22), a), (rrn(7), rrn(9)), (rrn(10), rrn(12))]</span></span><br><span class="line">        <span class="keyword">if</span> picked:</span><br><span class="line">            rnrn.append(picked[<span class="number">0</span>])</span><br><span class="line">        rnrn.extend(leftovers[:<span class="number">2</span>])</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(rnrn) &lt; <span class="number">3</span>:</span><br><span class="line">            <span class="comment"># 修正非法解包 True</span></span><br><span class="line">            rnrn = <span class="built_in">list</span>(((k, <span class="literal">True</span>) <span class="keyword">for</span> k, (tmp, v2) <span class="keyword">in</span> <span class="built_in">sorted</span>(hello.items())))[:<span class="number">3</span>]</span><br><span class="line">        base = <span class="number">0</span></span><br><span class="line">        <span class="comment"># 遍历rnrn的每一个点，</span></span><br><span class="line">        <span class="keyword">for</span> idx, (x, y) <span class="keyword">in</span> <span class="built_in">enumerate</span>(rnrn):</span><br><span class="line">            prod, sum_ = <span class="number">1</span>, <span class="number">1</span></span><br><span class="line">            <span class="keyword">for</span> j, (xj, yj) <span class="keyword">in</span> <span class="built_in">enumerate</span>(rnrn):</span><br><span class="line">                <span class="keyword">if</span> idx == j:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                prod = mul(prod, -xj) % rrn(<span class="number">1</span>)</span><br><span class="line">                sum_ = mul(sum_, x - xj) % rrn(<span class="number">1</span>)</span><br><span class="line">            tmp_ = mul(prod, inv(sum_, rrn(<span class="number">1</span>))) % rrn(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 输入3个字符串，转换为int</span></span><br><span class="line">    a = <span class="built_in">int</span>.from_bytes(<span class="built_in">input</span>(<span class="string">&#x27;1:&#x27;</span>).strip().encode())</span><br><span class="line">    b = <span class="built_in">int</span>.from_bytes(<span class="built_in">input</span>(<span class="string">&#x27;2:&#x27;</span>).strip().encode())</span><br><span class="line">    c = <span class="built_in">int</span>.from_bytes(<span class="built_in">input</span>(<span class="string">&#x27;3:&#x27;</span>).strip().encode())</span><br><span class="line">    <span class="comment"># 打印rrn(0)到rrn(29)的值</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">        <span class="built_in">print</span>(i, rrn(i))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">import</span> ipdb; ipdb.set_trace()</span><br><span class="line">    <span class="comment"># embed()</span></span><br><span class="line">    ok = rtnr(([rrn(<span class="number">22</span>), a , rrn(<span class="number">23</span>)], [rrn(<span class="number">24</span>), b, rrn(<span class="number">25</span>)], [rrn(<span class="number">26</span>), c, rrn(<span class="number">27</span>)]))</span><br><span class="line">    <span class="keyword">if</span> ok:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Success!&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Fail&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>$$rrn(2)^{v1}*rrn(3)^{v2} \equiv rrn(4)<em>rrn(5)^{k}</em> rrn(6)^{k^2} \mod rrn(0)$$</p>
<p>对于模M的乘法群，由于M是素数，所以这个群包含所有与M互素的数，也就是1到M-1的所有整数。rrn(0-29)均在模M的乘法群中，且理论上可以相互表示（群里的元素理论上均可以由同一个生成元生成）。</p>
<p>对于以上式子，可令g&#x3D;rrn(2)，h&#x3D;rrn(3)，那么按照群元素可互相转化的性质将4、5、6转化为</p>
<p>$$rrn(4)&#x3D;g^{a_1}<em>h^{a_2} \ rrn(5)&#x3D;g^{a_3}<em>h^{a_4} \ rrn(6)&#x3D;g^{a_5}<em>h^{a_6} \ 那么g^{v1}<em>h^{v2} \equiv g^{a_1+a_3</em>k+a_5</em>k^2}<em>h^{a_2+a_4</em>k+a_6</em>k^2} \mod M\ 可得v1\equiv a_1+a_3</em>k+a_5<em>k^2 \mod org(g),v2\equiv a_2+a_4</em>k+a_6*k^2 \mod org(h)$$</p>
<p>而对于模M的乘法群，由于M是素数，其乘法群的阶是 ϕ(M)&#x3D;M−1，并发现ϕ(M)&#x3D;M−1&#x3D;2⋅rrn(1)，且verify(k, v1, v2)函数中，<code>step = mul(step, k) % rrn(1)</code>可以看出，所有的k必须都能整除rrn(1)，因此可认为rrn(1)是群的阶，所以群元素g和h的阶也是rrn(1)，即</p>
<p>$$g^{rrn(1)}≡1\mod M\ 且h^{rrn(1)}≡1\mod M$$</p>
<p>因此化简后可得</p>
<p>$$v1\equiv a_1+a_3<em>k+a_5</em>k^2 \mod rrn(1)\ v2\equiv a_2+a_4<em>k+a_6</em>k^2 \mod rrn(1)$$</p>
<p>将triple中的三组数带入，拉格朗日插值即可求得多项式系数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage exp.sage</span></span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">q = <span class="number">2072401646708888065655225658747614353249565120522358335925242055144090041187149544083229647724359</span></span><br><span class="line">triple = [(<span class="number">51966</span>, <span class="number">480442839669953990717445646260333383833736214883976558477525831992994289143305421629761482429714</span>, <span class="number">680701978345522085049694956190292511497787092168524280991013677878931201637910598103187515536181</span>), (<span class="number">47806</span>, <span class="number">253717457675323180603201716971045682091261518437666533915787790782521696917056900361404824269689</span>, <span class="number">99768326317759269813131181172947299870925613919195157126671930387206518545837120733862757382354</span>), (<span class="number">201527</span>, <span class="number">782319055923618868639890136618720319997476308047895888006842867173403800015590219030945524995543</span>, <span class="number">944213788775446264472010893716848921879528565854393198519311752189219209422386607874556309845161</span>)]</span><br><span class="line"></span><br><span class="line">Fq = GF(q) </span><br><span class="line">points_v1 = [(Fq(point[<span class="number">0</span>]), Fq(point[<span class="number">1</span>])) <span class="keyword">for</span> point <span class="keyword">in</span> triple] <span class="comment"># [(k1, v11), (k2, v12), (k3, v13)]</span></span><br><span class="line">points_v2 = [(Fq(point[<span class="number">0</span>]), Fq(point[<span class="number">2</span>])) <span class="keyword">for</span> point <span class="keyword">in</span> triple] <span class="comment"># [(k1, v21), (k2, v22), (k3, v23)]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 拟合 P1(k) = a1 + a3*k + a5*k^2</span></span><br><span class="line">R.&lt;x&gt; = Fq[] <span class="comment"># 定义多项式环</span></span><br><span class="line">P1 = R.lagrange_polynomial(points_v1) </span><br><span class="line"><span class="comment"># 拟合 P2(k) = a2 + a4*k + a6*k^2</span></span><br><span class="line">P2 = R.lagrange_polynomial(points_v2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从多项式中提取系数</span></span><br><span class="line">coeffs_P1 = P1.coefficients(sparse=<span class="literal">False</span>)</span><br><span class="line">coeffs_P2 = P2.coefficients(sparse=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">a1 = coeffs_P1[<span class="number">0</span>] </span><br><span class="line">a3 = coeffs_P1[<span class="number">1</span>] </span><br><span class="line">a5 = coeffs_P1[<span class="number">2</span>] </span><br><span class="line">a2 = coeffs_P2[<span class="number">0</span>] </span><br><span class="line">a4 = coeffs_P2[<span class="number">1</span>] </span><br><span class="line">a6 = coeffs_P2[<span class="number">2</span>] </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;a1 = <span class="subst">&#123;a1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;a2 = <span class="subst">&#123;a2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;a3 = <span class="subst">&#123;a3&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;a4 = <span class="subst">&#123;a4&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;a5 = <span class="subst">&#123;a5&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;a6 = <span class="subst">&#123;a6&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">rrn_22 = <span class="number">4919</span></span><br><span class="line">rrn_23 = <span class="number">132146363252892079238955852043754382244951307426448497798760465957265430114543661757753602857394</span></span><br><span class="line">rrn_24 = <span class="number">57005</span></span><br><span class="line">rrn_25 = <span class="number">775309903033854570882823603825659470664893675806480830434450057789819902048494192286724670375083</span></span><br><span class="line">rrn_26 = <span class="number">48879</span></span><br><span class="line">rrn_27 = <span class="number">118549588096765345719828273586922254620646262475213503758232906237813765902929584873401252181598</span></span><br><span class="line"></span><br><span class="line">a = a1 + a3 * Fq(rrn_22) + a5 * Fq(rrn_22)^<span class="number">2</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;a = <span class="subst">&#123;a&#125;</span>&quot;</span>)</span><br><span class="line">b = a1 + a3 * Fq(rrn_24) + a5 * Fq(rrn_24)^<span class="number">2</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;b = <span class="subst">&#123;b&#125;</span>&quot;</span>)</span><br><span class="line">c = a1 + a3 * Fq(rrn_26) + a5 * Fq(rrn_26)^<span class="number">2</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">a1 = 559316565023500509472163049993035746991488808927332730492353543246322747488347594956218118830404</span></span><br><span class="line"><span class="string">a2 = 1455816338850548710226747826263500417489966228905173140760493856591277816261361853858359905028757</span></span><br><span class="line"><span class="string">a3 = 61893902729035082547018799981240740998667540081489595699162471822753113067844662646155561908655</span></span><br><span class="line"><span class="string">a4 = 301313555011896194349617605836195674760724652611645297927675988618321527633812527039080942153758</span></span><br><span class="line"><span class="string">a5 = 764625183014257783434933122874897790769847061090472271865906840925207049997560904718466470592181</span></span><br><span class="line"><span class="string">a6 = 1724301671569624190613193288495336271846478444752336504588582046652263520640553017091593670065559</span></span><br><span class="line"><span class="string">a = 871181771745415129676783034365082444498012594504484743519181302778728946421478110926096857920105</span></span><br><span class="line"><span class="string">b = 921176108142183962611682249614034391224389411635109144346285880896767581601955961667920137908837</span></span><br><span class="line"><span class="string">c = 794359266103212238415902312276062123896424792163905951086179313000078369166756222741109039129213</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<h1 id="baby-crt"><a href="#baby-crt" class="headerlink" title="baby_crt"></a>baby_crt</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, long_to_bytes, getStrongPrime</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha1</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, p, q</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_t</span>(<span class="params">d</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        t = getPrime(<span class="number">16</span>)</span><br><span class="line">        <span class="keyword">if</span> t % <span class="number">4</span> == <span class="number">3</span> <span class="keyword">and</span> libnum.gcd(d, t - <span class="number">1</span>) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> t</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">m, params</span>):</span><br><span class="line">    d, p, q, n, t1, t2, e1, e2 = params</span><br><span class="line">    dp = d % ((p - <span class="number">1</span>) * (t1 - <span class="number">1</span>))</span><br><span class="line">    dq = d % ((q - <span class="number">1</span>) * (t2 - <span class="number">1</span>))</span><br><span class="line">    k = getPrime(<span class="number">16</span>)</span><br><span class="line">    Sp = <span class="built_in">pow</span>(m + k, dp, p * t1)</span><br><span class="line">    Sq = <span class="built_in">pow</span>(m, dq, q * t2)</span><br><span class="line">    Cp = q * t2 * libnum.invmod(q * t2, p * t1)</span><br><span class="line">    Cq = p * t1 * libnum.invmod(p * t1, q * t2)</span><br><span class="line">    S = (Cp * Sp + Cq * Sq) % (n * t1 * t2)</span><br><span class="line">    c1 = (m - <span class="built_in">pow</span>(S, e1, t1) + <span class="number">1</span>) % t1</span><br><span class="line">    c2 = (m - <span class="built_in">pow</span>(S, e2, t2) + <span class="number">1</span>) % t2</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(S, c1 * c2, n)</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"><span class="keyword">assert</span> p &lt; q</span><br><span class="line"><span class="keyword">assert</span> flag == <span class="string">&quot;flag&#123;&quot;</span> + sha1(long_to_bytes(p)).hexdigest() + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">n = p*q</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line">d = libnum.invmod(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">t1 = gen_t(d)</span><br><span class="line">et1 = libnum.invmod(d, t1 - <span class="number">1</span>)</span><br><span class="line">t2 = gen_t(d)</span><br><span class="line">et2 = libnum.invmod(d, t2 - <span class="number">1</span>)</span><br><span class="line">params = (d, p, q, n, t1, t2, et1, et2)</span><br><span class="line">m = randint(<span class="number">1</span>, n-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line">sig = sign(m, params)</span><br><span class="line"><span class="built_in">print</span>(sig)</span><br></pre></td></tr></table></figure>

<p>先捋一下逻辑，输出了三个参数，n、m、sig，也就是output0中的三个数。</p>
<p>对于n，直接利用<a target="_blank" rel="noopener" href="https://factordb.com/%E5%88%86%E8%A7%A3%EF%BC%8C%E5%8F%AF%E7%9B%B4%E6%8E%A5%E5%BE%97%E5%88%B0p%E3%80%81q">https://factordb.com/分解，可直接得到p、q</a>(p&lt;q)。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p = 149580444233086025790179573414856711556292635219028492250676309233306926698347672114881938858364663009604584293251087505211665595084567645013671843742930965283973691725982783226085450276850737892819830479107029360437303876681309102929919702367620122904659518881851295355796994990602745486313662851309278333637</span><br><span class="line">q = 175947855464630318882274211369050447335314682338022384131546160543733195355501291230119719123032944939427500196558321955068490980548179604648557892933129317527213012520680627573834567002223872890806611275061140244033706361520509332755932759567357620312030849014630507761409535339555754829420991613721802012281</span><br></pre></td></tr></table></figure>

<p>不利用网站，分析一下数学原理：</p>
<p>已知n、e、m、sig，sig由函数sign生成，m∈[1,n-1]是随机整数</p>
<p>已知n，对于d，可知</p>
<p>$$<br>e*d\equiv 1 \mod \phi(n)\ \phi(n)&#x3D;(p-1)(q-1)<br>$$<br>t&#x3D;t1、t2由函数gen_t(d)生成，对于gen_t(d)，可知，t1、t2是16比特的素数（题目为二进制形式）</p>
<p>$$<br>t ≡ 3 \mod 4\ \gcd(d,t-1)<br>$$<br>对于et&#x3D;et1、et2，有</p>
<p>$$<br>et*d \equiv 1 \mod (t-1)<br>$$<br>接下来用d, p, q, n, t1, t2, et1, et2对消息m进行签名，得到sig &#x3D; sign(m, params)。</p>
<p>对于sign(m, params)，可知，k也是16比特的素数</p>
<p>$$<br>\begin{aligned} dp &amp;\equiv d \mod \phi(p<em>t1)\ dq &amp;\equiv d \mod \phi(q</em>t2)\ Sp &amp;\equiv (m+k)^{dp} \mod (p<em>t1)\ Sq &amp;\equiv m^{dq} \mod (q</em>t2)\ Cp &amp;\equiv q<em>t2</em>((q<em>t2)^{-1}\mod (p</em>t1))\ Cq &amp;\equiv p<em>t1</em>((p<em>t1)^{-1}\mod (q</em>t2))\ S &amp;\equiv Cp<em>Sp+Cq</em>Sq \mod (p<em>q</em>t1<em>t2)\ c1 &amp;\equiv m-S^{et1} +1 \mod t1\ c2 &amp;\equiv m-S^{et2} +1 \mod t2\ sig &amp;\equiv S^{c1</em>c2} \mod n\ \end{aligned}<br>$$<br>对于Sp、Sq、Cp、Cq、S，考虑中国剩余定理：</p>
<p>$$<br>x ≡ \sum_{i&#x3D;1}^{n}(a_i * M&#x2F;m_i * [(M&#x2F;m_i)^{-1}\pmod {m_i}]) \pmod M,\ M&#x3D;\prod_{i&#x3D;1}^n{m_i},\ \begin{cases}    x ≡ a_1 \pmod {m_1} \    x ≡ a_2 \pmod {m_2} \     …\    x ≡ a_n \pmod {m_n}  \end{cases}<br>$$<br>因此可得</p>
<p>$$<br>S \equiv Sp \mod(p<em>t1)\ S \equiv Sq \mod(q</em>t2)<br>$$<br>而模运算具备性质</p>
<p>$$<br>若a ≡ b \mod (m*n),\ 则a ≡ b \mod m,a ≡ b \mod n<br>$$<br>那么可得到</p>
<p>$$<br>\begin{aligned} S &amp;\equiv (m+k)^{dp} \mod p\ S &amp;\equiv (m+k)^{dp} \mod t1\ S &amp;\equiv m^{dq} \mod q\ S &amp;\equiv m^{dq} \mod t2\ dp &amp;\equiv d \mod (p-1)\ dp &amp;\equiv d \mod (t1-1)\ dq &amp;\equiv d \mod (q-1)\ dq &amp;\equiv d \mod (t2-1)\ et1 &amp;\equiv d^{-1} \mod (t1-1)\ et2 &amp;\equiv d^{-1} \mod (t2-1) \end{aligned}<br>$$<br>那么由</p>
<p>$$<br>\begin{aligned} S &amp;\equiv (m+k)^{dp} \mod t1\ dp &amp;\equiv d \mod (t1-1)\ et1 &amp;\equiv d^{-1} \mod (t1-1)\ \end{aligned}</p>
<p>可得<br>$$</p>
<p>$$<br>\begin{aligned} S^{et1} \mod t1 &amp;\equiv (m+k)^{dp<em>et1} \mod t1 \ &amp;\equiv (m+k)^{d</em>d^{-1} \mod (t1-1)} \mod t1 \ &amp;\equiv m+k \mod t1 \ \end{aligned}<br>$$</p>
<p>同理，由</p>
<p>$$<br>\begin{aligned} S &amp;\equiv m^{dp} \mod t2\ dq &amp;\equiv d \mod (t2-1)\ et2 &amp;\equiv d^{-1} \mod (t2-1) \end{aligned}<br>$$<br>可得</p>
<p>$$<br>\begin{aligned} S^{et2} \mod t1 &amp;\equiv m^{dq<em>et2} \mod t2 \ &amp;\equiv m^{d</em>d^{-1} \mod (t2-1)} \mod t2 \ &amp;\equiv m \mod t2 \ \end{aligned}<br>$$<br>因此根据</p>
<p>$$<br>\begin{aligned} S^{et1} \mod t1 &amp;\equiv m+k \mod t1 \ S^{et2} \mod t1 &amp;\equiv m \mod t2 \ \end{aligned}<br>$$<br>可得</p>
<p>$$<br>\begin{aligned} c1 &amp;\equiv m-S^{et1} +1 \mod t1\ &amp;\equiv m-(m+k+a<em>t1)+1 \mod t1\ &amp;\equiv 1-k \mod t1 \ &amp;&#x3D;1-k+a</em>t1\ c2 &amp;\equiv m-S^{et2} +1 \mod t2\ &amp;\equiv m-(m+b*t2)+1 \mod t2\ &amp;\equiv 1 \mod t2\ \end{aligned}<br>$$<br>那么取c2&#x3D;1，将S化简为Sq mod q（Sq未知量少），并根据上面的式子可推导</p>
<p>$$<br>\begin{aligned} sig &amp;\equiv S^{c1<em>c2} \mod n\ &amp;\equiv S^{1-k+a</em>t1} \mod n \ &amp;\equiv S_q^{1-k+a<em>t1} \mod q \ &amp;\equiv S_q \mod q\ sig^e &amp;\equiv S_q^e \mod q\ &amp;\equiv m^{dq</em>e} \mod q\ &amp;\equiv m^{1 \mod q-1} \mod q\ &amp;\equiv m^{1+c(q-1)} \mod q\ &amp;\equiv m \mod q\ sig^e &amp;\equiv S_q^{e*(1-k+a<em>t1)} \mod q\ &amp;\equiv m^{1-k+a</em>t1} \mod q \end{aligned}<br>$$<br>也就是说，可以通过求最大公约数得到q</p>
<p>$$<br>m^{1-k+a<em>t1}-sig^e|q\ \Rightarrow \gcd((m^{1-k+a</em>t1}-sig^e),n)&#x3D;q≠1<br>$$</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha1</span><br><span class="line"></span><br><span class="line">n = <span class="number">26318358382258215770827770763384603359524444566146134039272065206657135513496897321983920652242182112479484135343436206815722605756557098241887233837248519031879444740922789351356138322947108346833956405647578838873425658405513192437479359531790697924285889505666769580176431360506227506064132034621123828090480606055877425480739950809109048177976884825589023444901953529913585288143291544181183810227553891973915960951526154469344587083295640034876874318610991153058462811369615555470571469517472865469502025030548451296909857667669963720366290084062470583318590585472209798523021029182199921435625983186101089395997</span></span><br><span class="line">m = <span class="number">26275493320706026144196966398886196833815170413807705805287763413013100962831703774640332765503838087434904835657988276064660304427802961609185997964665440867416900711128517859267504657627160598700248689738045243142111489179673375819308779535247214660694211698799461044354352200950309392321861021920968200334344131893259850468214901266208090469265809729514249143938043521579678234754670097056281556861805568096657415974805578299196440362791907408888958917063668867208257370099324084840742435785960681801625180611324948953657666742195051492610613830629731633827861546693629268844700581558851830936504144170791124745540</span></span><br><span class="line">sig = <span class="number">20152941369122888414130075002845764046912727471716839854671280255845798928738103824595339885345405419943354215456598381228519131902698373225795339649300359363119754605698321052334731477127433796964107633109608706030111197156701607379086766944096066649323367976786383015106681896479446835419143225832320978530554399851074180762308322092339721839566642144908864530466017614731679525392259796511789624080228587080621454084957169193343724515867468178242402356741884890739873250658960438450287159439457730127074563991513030091456771906853781028159857466498315359846665211412644316716082898396009119848634426989676119219246</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">sig_e_1 = <span class="built_in">pow</span>(sig,e,n)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65536</span>):</span><br><span class="line">    sig_e_2 = <span class="built_in">pow</span>(m,i,n)</span><br><span class="line">    <span class="keyword">if</span> gmpy2.gcd((sig_e_2-sig_e_1),n) !=<span class="number">1</span>:</span><br><span class="line">        q = gmpy2.gcd((sig_e_2-sig_e_1)%n,n)</span><br><span class="line">        p = n // q</span><br><span class="line">        <span class="keyword">assert</span> p * q == n</span><br><span class="line">        <span class="built_in">print</span>(p)</span><br><span class="line">        flag = sha1(long_to_bytes(p)).hexdigest()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;flag&#123;&quot;</span>+flag+<span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h1 id=""><a href="#" class="headerlink" title=""></a></h1>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/11/02/qwb2020-crypto/" data-id="cuidOvvP1WG2XapC7cKqzMiPm" data-title="qwb2020-crypto" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/11/06/qwb2020-re/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          qwb2020-re
        
      </div>
    </a>
  
  
    <a href="/2020/03/30/2020volgactf/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">VolgaCTF 2020</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/11/">November 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/10/">October 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/09/">September 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/08/">August 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/11/">November 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">November 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/07/">July 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">May 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">September 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">August 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2025/11/18/n1ctfjunior-re/">n1ctfjunior-re。</a>
          </li>
        
          <li>
            <a href="/2025/11/01/qwb2025-re/">qwb2025-re。</a>
          </li>
        
          <li>
            <a href="/2025/10/25/qwb2025-pwn/">qwb2025-pwn flagmarket。</a>
          </li>
        
          <li>
            <a href="/2025/10/10/junior/">n1ctf junior 2/2 web。</a>
          </li>
        
          <li>
            <a href="/2025/10/09/2025crewctf/">crewCTF2025。</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 xrivendell7<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>